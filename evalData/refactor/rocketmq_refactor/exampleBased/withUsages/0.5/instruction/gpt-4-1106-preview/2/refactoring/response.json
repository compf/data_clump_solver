{
    "refactorings": {
        "store/src/main/java/org/apache/rocketmq/store/stats/BrokerStatsManager.java": [
            {
                "fromLine": 24,
                "toLine": 24,
                "oldContent": "    private final String clusterName;",
                "newContent": "    private BrokerClusterInfo brokerClusterInfo;"
            },
            {
                "fromLine": 80,
                "toLine": 80,
                "oldContent": "        this.clusterName = brokerConfig.getBrokerClusterName();",
                "newContent": "        this.brokerClusterInfo = new BrokerClusterInfo(brokerConfig.getBrokerClusterName());"
            },
            {
                "fromLine": 85,
                "toLine": 85,
                "oldContent": "        this.clusterName = clusterName;",
                "newContent": "        this.brokerClusterInfo = new BrokerClusterInfo(clusterName);"
            },
            {
                "fromLine": 299,
                "toLine": 299,
                "oldContent": "        this.statsTable.get(CONSUMER_REGISTER_TIME).addValue(this.clusterName, incValue, 1);",
                "newContent": "        this.statsTable.get(CONSUMER_REGISTER_TIME).addValue(brokerClusterInfo.getClusterName(), incValue, 1);"
            },
            {
                "fromLine": 303,
                "toLine": 303,
                "oldContent": "        this.statsTable.get(PRODUCER_REGISTER_TIME).addValue(this.clusterName, incValue, 1);",
                "newContent": "        this.statsTable.get(PRODUCER_REGISTER_TIME).addValue(brokerClusterInfo.getClusterName(), incValue, 1);"
            },
            {
                "fromLine": 412,
                "toLine": 412,
                "oldContent": "        this.statsTable.get(Stats.BROKER_PUT_NUMS).getAndCreateStatsItem(this.clusterName).getValue().add(1);",
                "newContent": "        this.statsTable.get(Stats.BROKER_PUT_NUMS).getAndCreateStatsItem(brokerClusterInfo.getClusterName()).getValue().add(1);"
            },
            {
                "fromLine": 416,
                "toLine": 416,
                "oldContent": "        this.statsTable.get(Stats.BROKER_PUT_NUMS).getAndCreateStatsItem(this.clusterName).getValue().add(incValue);",
                "newContent": "        this.statsTable.get(Stats.BROKER_PUT_NUMS).getAndCreateStatsItem(brokerClusterInfo.getClusterName()).getValue().add(incValue);"
            },
            {
                "fromLine": 420,
                "toLine": 420,
                "oldContent": "        this.statsTable.get(Stats.BROKER_GET_NUMS).getAndCreateStatsItem(this.clusterName).getValue().add(incValue);",
                "newContent": "        this.statsTable.get(Stats.BROKER_GET_NUMS).getAndCreateStatsItem(brokerClusterInfo.getClusterName()).getValue().add(incValue);"
            },
            {
                "fromLine": 424,
                "toLine": 424,
                "oldContent": "        this.statsTable.get(BROKER_ACK_NUMS).getAndCreateStatsItem(this.clusterName).getValue().add(incValue);",
                "newContent": "        this.statsTable.get(BROKER_ACK_NUMS).getAndCreateStatsItem(brokerClusterInfo.getClusterName()).getValue().add(incValue);"
            },
            {
                "fromLine": 428,
                "toLine": 428,
                "oldContent": "        this.statsTable.get(BROKER_CK_NUMS).getAndCreateStatsItem(this.clusterName).getValue().add(incValue);",
                "newContent": "        this.statsTable.get(BROKER_CK_NUMS).getAndCreateStatsItem(brokerClusterInfo.getClusterName()).getValue().add(incValue);"
            },
            {
                "fromLine": 432,
                "toLine": 432,
                "oldContent": "        this.statsTable.get(BROKER_GET_NUMS_WITHOUT_SYSTEM_TOPIC).getAndCreateStatsItem(this.clusterName).getValue().add(incValue);",
                "newContent": "        this.statsTable.get(BROKER_GET_NUMS_WITHOUT_SYSTEM_TOPIC).getAndCreateStatsItem(brokerClusterInfo.getClusterName()).getValue().add(incValue);"
            },
            {
                "fromLine": 436,
                "toLine": 436,
                "oldContent": "        this.statsTable.get(BROKER_PUT_NUMS_WITHOUT_SYSTEM_TOPIC).getAndCreateStatsItem(this.clusterName).getValue().add(incValue);",
                "newContent": "        this.statsTable.get(BROKER_PUT_NUMS_WITHOUT_SYSTEM_TOPIC).getAndCreateStatsItem(brokerClusterInfo.getClusterName()).getValue().add(incValue);"
            },
            {
                "fromLine": 448,
                "toLine": 448,
                "oldContent": "        final StatsItem statsItem = statsItemSet.getStatsItem(this.clusterName);",
                "newContent": "        final StatsItem statsItem = statsItemSet.getStatsItem(brokerClusterInfo.getClusterName());"
            },
            {
                "fromLine": 457,
                "toLine": 457,
                "oldContent": "        final StatsItem statsItem = statsItemSet.getStatsItem(this.clusterName);",
                "newContent": "        final StatsItem statsItem = statsItemSet.getStatsItem(brokerClusterInfo.getClusterName());"
            }
        ]
    },
    "extractedClasses": {
        "store/src/main/java/org/apache/rocketmq/store/stats/BrokerClusterInfo.java": "package org.apache.rocketmq.store.stats;\n\npublic class BrokerClusterInfo {\n    private final String clusterName;\n\n    public BrokerClusterInfo(String clusterName) {\n        this.clusterName = clusterName;\n    }\n\n    public String getClusterName() {\n        return clusterName;\n    }\n}\n"
    }
}