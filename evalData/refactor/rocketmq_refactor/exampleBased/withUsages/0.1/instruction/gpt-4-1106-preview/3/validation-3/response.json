{
    "refactorings": {
        "store/src/main/java/org/apache/rocketmq/store/stats/BrokerStatsManager.java": [
            {
                "fromLine": 155,
                "toLine": 155,
                "oldContent": "    private BrokerConfig brokerConfig;",
                "newContent": "    private BrokerConfig brokerConfig;\n    private HashMap<String, StatsItemSet> statsTable = new HashMap<>();\n    private MomentStatsItemSet momentStatsItemSetFallSize;\n    private MomentStatsItemSet momentStatsItemSetFallTime;\n    private StatisticsManager accountStatManager = new StatisticsManager();\n    private StateGetter producerStateGetter;\n    private StateGetter consumerStateGetter;"
            },
            {
                "fromLine": 170,
                "toLine": 170,
                "oldContent": "        momentStatsItemSetFallSize = new MomentStatsItemSet(GROUP_GET_FALL_SIZE,",
                "newContent": "        this.momentStatsItemSetFallSize = new MomentStatsItemSet(GROUP_GET_FALL_SIZE,"
            },
            {
                "fromLine": 173,
                "toLine": 173,
                "oldContent": "        momentStatsItemSetFallTime = new MomentStatsItemSet(GROUP_GET_FALL_TIME,",
                "newContent": "        this.momentStatsItemSetFallTime = new MomentStatsItemSet(GROUP_GET_FALL_TIME,"
            },
            {
                "fromLine": 177,
                "toLine": 177,
                "oldContent": "        if (this.enableQueueStat) {",
                "newContent": "        if (enableQueueStat) {"
            },
            {
                "fromLine": 235,
                "toLine": 235,
                "oldContent": "        this.accountStatManager.setBriefMeta(new Pair[] {",
                "newContent": "        accountStatManager.setBriefMeta(new Pair[] {"
            },
            {
                "fromLine": 243,
                "toLine": 243,
                "oldContent": "        this.accountStatManager.addStatisticsKindMeta(createStatisticsKindMeta(",
                "newContent": "        accountStatManager.addStatisticsKindMeta(createStatisticsKindMeta("
            },
            {
                "fromLine": 245,
                "toLine": 245,
                "oldContent": "        this.accountStatManager.addStatisticsKindMeta(createStatisticsKindMeta(",
                "newContent": "        accountStatManager.addStatisticsKindMeta(createStatisticsKindMeta("
            },
            {
                "fromLine": 247,
                "toLine": 247,
                "oldContent": "        this.accountStatManager.addStatisticsKindMeta(createStatisticsKindMeta(",
                "newContent": "        accountStatManager.addStatisticsKindMeta(createStatisticsKindMeta("
            },
            {
                "fromLine": 249,
                "toLine": 249,
                "oldContent": "        this.accountStatManager.addStatisticsKindMeta(createStatisticsKindMeta(",
                "newContent": "        accountStatManager.addStatisticsKindMeta(createStatisticsKindMeta("
            },
            {
                "fromLine": 251,
                "toLine": 251,
                "oldContent": "        this.accountStatManager.addStatisticsKindMeta(createStatisticsKindMeta(",
                "newContent": "        accountStatManager.addStatisticsKindMeta(createStatisticsKindMeta("
            },
            {
                "fromLine": 253,
                "toLine": 253,
                "oldContent": "        this.accountStatManager.addStatisticsKindMeta(createStatisticsKindMeta(",
                "newContent": "        accountStatManager.addStatisticsKindMeta(createStatisticsKindMeta("
            },
            {
                "fromLine": 277,
                "toLine": 277,
                "oldContent": "                    return this.producerStateGetter.online(instanceId, group, topic);",
                "newContent": "                    return producerStateGetter.online(instanceId, group, topic);"
            },
            {
                "fromLine": 279,
                "toLine": 279,
                "oldContent": "                    return this.consumerStateGetter.online(instanceId, group, topic);",
                "newContent": "                    return consumerStateGetter.online(instanceId, group, topic);"
            },
            {
                "fromLine": 255,
                "toLine": 255,
                "oldContent": "        this.accountStatManager.setStatisticsItemStateGetter(new StatisticsItemStateGetter() {",
                "newContent": "        accountStatManager.setStatisticsItemStateGetter(new StatisticsItemStateGetter() {"
            },
            {
                "fromLine": 288,
                "toLine": 288,
                "oldContent": "                        return Math.abs(UtilAll.computeNextMinutesTimeMillis() - System.currentTimeMillis());",
                "newContent": "                        return Math.abs(UtilAll.computeNextMinutesTimeMillis() - System.currentTimeMillis());"
            },
            {
                "fromLine": 290,
                "toLine": 290,
                "oldContent": "                        return this.brokerConfig != null ? this.brokerConfig.isAccountStatsEnable() : true;",
                "newContent": "                        return brokerConfig != null ? brokerConfig.isAccountStatsEnable() : true;"
            },
            {
                "fromLine": 292,
                "toLine": 292,
                "oldContent": "                        return this.brokerConfig != null ? this.brokerConfig.isAccountStatsPrintZeroValues() : true;",
                "newContent": "                        return brokerConfig != null ? brokerConfig.isAccountStatsPrintZeroValues() : true;"
            },
            {
                "fromLine": 296,
                "toLine": 296,
                "oldContent": "        return this.momentStatsItemSetFallSize;",
                "newContent": "        return momentStatsItemSetFallSize;"
            },
            {
                "fromLine": 300,
                "toLine": 300,
                "oldContent": "        return this.momentStatsItemSetFallTime;",
                "newContent": "        return momentStatsItemSetFallTime;"
            },
            {
                "fromLine": 304,
                "toLine": 304,
                "oldContent": "        return this.producerStateGetter;",
                "newContent": "        return producerStateGetter;"
            },
            {
                "fromLine": 308,
                "toLine": 308,
                "oldContent": "        this.producerStateGetter = producerStateGetter;",
                "newContent": "        producerStateGetter = producerStateGetter;"
            },
            {
                "fromLine": 312,
                "toLine": 312,
                "oldContent": "        return this.consumerStateGetter;",
                "newContent": "        return consumerStateGetter;"
            },
            {
                "fromLine": 316,
                "toLine": 316,
                "oldContent": "        this.consumerStateGetter = consumerStateGetter;",
                "newContent": "        consumerStateGetter = consumerStateGetter;"
            },
            {
                "fromLine": 329,
                "toLine": 329,
                "oldContent": "            return this.statsTable.get(statsName).getStatsItem(statsKey);",
                "newContent": "            return statsTable.get(statsName).getStatsItem(statsKey);"
            },
            {
                "fromLine": 337,
                "toLine": 337,
                "oldContent": "        this.statsTable.get(Stats.TOPIC_PUT_NUMS).delValue(topic);",
                "newContent": "        statsTable.get(Stats.TOPIC_PUT_NUMS).delValue(topic);"
            },
            {
                "fromLine": 338,
                "toLine": 338,
                "oldContent": "        this.statsTable.get(Stats.TOPIC_PUT_SIZE).delValue(topic);",
                "newContent": "        statsTable.get(Stats.TOPIC_PUT_SIZE).delValue(topic);"
            },
            {
                "fromLine": 340,
                "toLine": 340,
                "oldContent": "            this.statsTable.get(Stats.QUEUE_PUT_NUMS).delValueByPrefixKey(topic, \"@\");",
                "newContent": "            statsTable.get(Stats.QUEUE_PUT_NUMS).delValueByPrefixKey(topic, \"@\");"
            },
            {
                "fromLine": 341,
                "toLine": 341,
                "oldContent": "            this.statsTable.get(Stats.QUEUE_PUT_SIZE).delValueByPrefixKey(topic, \"@\");",
                "newContent": "            statsTable.get(Stats.QUEUE_PUT_SIZE).delValueByPrefixKey(topic, \"@\");"
            },
            {
                "fromLine": 343,
                "toLine": 343,
                "oldContent": "        this.statsTable.get(Stats.GROUP_GET_NUMS).delValueByPrefixKey(topic, \"@\");",
                "newContent": "        statsTable.get(Stats.GROUP_GET_NUMS).delValueByPrefixKey(topic, \"@\");"
            },
            {
                "fromLine": 344,
                "toLine": 344,
                "oldContent": "        this.statsTable.get(Stats.GROUP_GET_SIZE).delValueByPrefixKey(topic, \"@\");",
                "newContent": "        statsTable.get(Stats.GROUP_GET_SIZE).delValueByPrefixKey(topic, \"@\");"
            },
            {
                "fromLine": 345,
                "toLine": 345,
                "oldContent": "        this.statsTable.get(Stats.QUEUE_GET_NUMS).delValueByPrefixKey(topic, \"@\");",
                "newContent": "        statsTable.get(Stats.QUEUE_GET_NUMS).delValueByPrefixKey(topic, \"@\");"
            },
            {
                "fromLine": 346,
                "toLine": 346,
                "oldContent": "        this.statsTable.get(Stats.QUEUE_GET_SIZE).delValueByPrefixKey(topic, \"@\");",
                "newContent": "        statsTable.get(Stats.QUEUE_GET_SIZE).delValueByPrefixKey(topic, \"@\");"
            },
            {
                "fromLine": 347,
                "toLine": 347,
                "oldContent": "        this.statsTable.get(Stats.SNDBCK_PUT_NUMS).delValueByPrefixKey(topic, \"@\");",
                "newContent": "        statsTable.get(Stats.SNDBCK_PUT_NUMS).delValueByPrefixKey(topic, \"@\");"
            },
            {
                "fromLine": 348,
                "toLine": 348,
                "oldContent": "        this.statsTable.get(Stats.GROUP_GET_LATENCY).delValueByInfixKey(topic, \"@\");",
                "newContent": "        statsTable.get(Stats.GROUP_GET_LATENCY).delValueByInfixKey(topic, \"@\");"
            },
            {
                "fromLine": 349,
                "toLine": 349,
                "oldContent": "        this.momentStatsItemSetFallSize.delValueByInfixKey(topic, \"@\");",
                "newContent": "        momentStatsItemSetFallSize.delValueByInfixKey(topic, \"@\");"
            },
            {
                "fromLine": 350,
                "toLine": 350,
                "oldContent": "        this.momentStatsItemSetFallTime.delValueByInfixKey(topic, \"@\");",
                "newContent": "        momentStatsItemSetFallTime.delValueByInfixKey(topic, \"@\");"
            },
            {
                "fromLine": 354,
                "toLine": 354,
                "oldContent": "        this.statsTable.get(Stats.GROUP_GET_NUMS).delValueBySuffixKey(group, \"@\");",
                "newContent": "        statsTable.get(Stats.GROUP_GET_NUMS).delValueBySuffixKey(group, \"@\");"
            },
            {
                "fromLine": 355,
                "toLine": 355,
                "oldContent": "        this.statsTable.get(Stats.GROUP_GET_SIZE).delValueBySuffixKey(group, \"@\");",
                "newContent": "        statsTable.get(Stats.GROUP_GET_SIZE).delValueBySuffixKey(group, \"@\");"
            },
            {
                "fromLine": 357,
                "toLine": 357,
                "oldContent": "            this.statsTable.get(Stats.QUEUE_GET_NUMS).delValueBySuffixKey(group, \"@\");",
                "newContent": "            statsTable.get(Stats.QUEUE_GET_NUMS).delValueBySuffixKey(group, \"@\");"
            },
            {
                "fromLine": 358,
                "toLine": 358,
                "oldContent": "            this.statsTable.get(Stats.QUEUE_GET_SIZE).delValueBySuffixKey(group, \"@\");",
                "newContent": "            statsTable.get(Stats.QUEUE_GET_SIZE).delValueBySuffixKey(group, \"@\");"
            },
            {
                "fromLine": 360,
                "toLine": 360,
                "oldContent": "        this.statsTable.get(Stats.SNDBCK_PUT_NUMS).delValueBySuffixKey(group, \"@\");",
                "newContent": "        statsTable.get(Stats.SNDBCK_PUT_NUMS).delValueBySuffixKey(group, \"@\");"
            },
            {
                "fromLine": 361,
                "toLine": 361,
                "oldContent": "        this.statsTable.get(Stats.GROUP_GET_LATENCY).delValueBySuffixKey(group, \"@\");",
                "newContent": "        statsTable.get(Stats.GROUP_GET_LATENCY).delValueBySuffixKey(group, \"@\");"
            },
            {
                "fromLine": 362,
                "toLine": 362,
                "oldContent": "        this.momentStatsItemSetFallSize.delValueBySuffixKey(group, \"@\");",
                "newContent": "        momentStatsItemSetFallSize.delValueBySuffixKey(group, \"@\");"
            },
            {
                "fromLine": 363,
                "toLine": 363,
                "oldContent": "        this.momentStatsItemSetFallTime.delValueBySuffixKey(group, \"@\");",
                "newContent": "        momentStatsItemSetFallTime.delValueBySuffixKey(group, \"@\");"
            },
            {
                "fromLine": 368,
                "toLine": 368,
                "oldContent": "        if (enableQueueStat) {",
                "newContent": "        if (this.enableQueueStat) {"
            },
            {
                "fromLine": 374,
                "toLine": 374,
                "oldContent": "            this.statsTable.get(Stats.QUEUE_PUT_NUMS).addValue(buildStatsKey(topic, queueId), 1, 1);",
                "newContent": "            statsTable.get(Stats.QUEUE_PUT_NUMS).addValue(buildStatsKey(topic, queueId), 1, 1);"
            },
            {
                "fromLine": 380,
                "toLine": 380,
                "oldContent": "            this.statsTable.get(Stats.QUEUE_PUT_NUMS).addValue(buildStatsKey(topic, queueId), num, times);",
                "newContent": "            statsTable.get(Stats.QUEUE_PUT_NUMS).addValue(buildStatsKey(topic, queueId), num, times);"
            },
            {
                "fromLine": 387,
                "toLine": 387,
                "oldContent": "            this.statsTable.get(Stats.QUEUE_PUT_SIZE).addValue(buildStatsKey(topic, queueId), size, 1);",
                "newContent": "            statsTable.get(Stats.QUEUE_PUT_SIZE).addValue(buildStatsKey(topic, queueId), size, 1);"
            },
            {
                "fromLine": 394,
                "toLine": 394,
                "oldContent": "            final String statsKey = buildStatsKey(topic, queueId, group);",
                "newContent": "            final String statsKey = buildStatsKey(topic, queueId, group);"
            },
            {
                "fromLine": 399,
                "toLine": 399,
                "oldContent": "            this.statsTable.get(Stats.QUEUE_GET_NUMS).addValue(statsKey, incValue, 1);",
                "newContent": "            statsTable.get(Stats.QUEUE_GET_NUMS).addValue(statsKey, incValue, 1);"
            },
            {
                "fromLine": 403,
                "toLine": 403,
                "oldContent": "            final String statsKey = buildStatsKey(topic, queueId, group);",
                "newContent": "            final String statsKey = buildStatsKey(topic, queueId, group);"
            },
            {
                "fromLine": 407,
                "toLine": 407,
                "oldContent": "            this.statsTable.get(Stats.QUEUE_GET_SIZE).addValue(statsKey, incValue, 1);",
                "newContent": "            statsTable.get(Stats.QUEUE_GET_SIZE).addValue(statsKey, incValue, 1);"
            },
            {
                "fromLine": 411,
                "toLine": 411,
                "oldContent": "        this.statsTable.get(CONSUMER_REGISTER_TIME).addValue(this.clusterName, incValue, 1);",
                "newContent": "        statsTable.get(CONSUMER_REGISTER_TIME).addValue(this.clusterName, incValue, 1);"
            },
            {
                "fromLine": 415,
                "toLine": 415,
                "oldContent": "        this.statsTable.get(PRODUCER_REGISTER_TIME).addValue(this.clusterName, incValue, 1);",
                "newContent": "        statsTable.get(PRODUCER_REGISTER_TIME).addValue(this.clusterName, incValue, 1);"
            },
            {
                "fromLine": 419,
                "toLine": 419,
                "oldContent": "        this.statsTable.get(CHANNEL_ACTIVITY).addValue(CHANNEL_ACTIVITY_CONNECT, 1, 1);",
                "newContent": "        statsTable.get(CHANNEL_ACTIVITY).addValue(CHANNEL_ACTIVITY_CONNECT, 1, 1);"
            },
            {
                "fromLine": 423,
                "toLine": 423,
                "oldContent": "        this.statsTable.get(CHANNEL_ACTIVITY).addValue(CHANNEL_ACTIVITY_IDLE, 1, 1);",
                "newContent": "        statsTable.get(CHANNEL_ACTIVITY).addValue(CHANNEL_ACTIVITY_IDLE, 1, 1);"
            },
            {
                "fromLine": 427,
                "toLine": 427,
                "oldContent": "        this.statsTable.get(Stats.TOPIC_PUT_NUMS).addValue(topic, 1, 1);",
                "newContent": "        statsTable.get(Stats.TOPIC_PUT_NUMS).addValue(topic, 1, 1);"
            },
            {
                "fromLine": 431,
                "toLine": 431,
                "oldContent": "        this.statsTable.get(Stats.TOPIC_PUT_NUMS).addValue(topic, num, times);",
                "
{
                "fromLine": 431,
                "toLine": 431,
                "oldContent": "        this.statsTable.get(Stats.TOPIC_PUT_NUMS).addValue(topic, num, times);",
                "newContent": "        statsTable.get(Stats.TOPIC_PUT_NUMS).addValue(topic, num, times);"
            }
       			            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
       		            
        			
       		            
       		            
       		            
        			
       		            
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			

        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			

        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			

        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			

        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
        			
