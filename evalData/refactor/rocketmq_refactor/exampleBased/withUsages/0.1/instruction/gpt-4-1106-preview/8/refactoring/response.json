
{
    "refactorings": {
        "store/src/main/java/org/apache/rocketmq/store/stats/BrokerStatsManager.java": [
            {
                "fromLine": 1,
                "toLine": 1,
                "oldContent": "package org.apache.rocketmq.store.stats;",
                "newContent": "package org.apache.rocketmq.store.stats;\n\nimport org.apache.rocketmq.store.stats.dataclumps.StatsKeyBuilder;"
            },
            {
                "fromLine": 112,
                "toLine": 112,
                "oldContent": "    public String buildStatsKey(String topic, String group) {",
                "newContent": "    public String buildStatsKey(StatsKeyBuilder statsKeyBuilder) {"
            },
            {
                "fromLine": 113,
                "toLine": 113,
                "oldContent": "        StringBuilder strBuilder;",
                "newContent": "        return statsKeyBuilder.buildStatsKey();"
            },
            {
                "fromLine": 114,
                "toLine": 118,
                "oldContent": "        if (topic != null && group != null) {\n            strBuilder = new StringBuilder(topic.length() + group.length() + 1);\n        } else {\n            strBuilder = new StringBuilder();\n        }",
                "newContent": ""
            },
            {
                "fromLine": 119,
                "toLine": 121,
                "oldContent": "        strBuilder.append(topic).append(\"@\").append(group);\n        return strBuilder.toString();\n    }",
                "newContent": ""
            },
            {
                "fromLine": 123,
                "toLine": 123,
                "oldContent": "    public String buildStatsKey(String topic, int queueId) {",
                "newContent": "    public String buildStatsKey(StatsKeyBuilder statsKeyBuilder) {"
            },
            {
                "fromLine": 124,
                "toLine": 124,
                "oldContent": "        StringBuilder strBuilder;",
                "newContent": "        return statsKeyBuilder.buildStatsKey();"
            },
            {
                "fromLine": 125,
                "toLine": 129,
                "oldContent": "        if (topic != null) {\n            strBuilder = new StringBuilder(topic.length() + 5);\n        } else {\n            strBuilder = new StringBuilder();\n        }",
                "newContent": ""
            },
            {
                "fromLine": 130,
                "toLine": 132,
                "oldContent": "        strBuilder.append(topic).append(\"@\").append(queueId);\n        return strBuilder.toString();\n    }",
                "newContent": ""
            },
            {
                "fromLine": 134,
                "toLine": 134,
                "oldContent": "    public String buildStatsKey(String topic, int queueId, String group) {",
                "newContent": "    public String buildStatsKey(StatsKeyBuilder statsKeyBuilder) {"
            },
            {
                "fromLine": 135,
                "toLine": 135,
                "oldContent": "        StringBuilder strBuilder;",
                "newContent": "        return statsKeyBuilder.buildStatsKey();"
            },
            {
                "fromLine": 136,
                "toLine": 140,
                "oldContent": "        if (topic != null && group != null) {\n            strBuilder = new StringBuilder(topic.length() + group.length() + 6);\n        } else {\n            strBuilder = new StringBuilder();\n        }",
                "newContent": ""
            },
            {
                "fromLine": 141,
                "toLine": 143,
                "oldContent": "        strBuilder.append(topic).append(\"@\").append(queueId).append(\"@\").append(group);\n        return strBuilder.toString();\n    }",
                "newContent": ""
            },
            {
                "fromLine": 145,
                "toLine": 145,
                "oldContent": "    public String buildStatsKey(int queueId, String topic, String group) {",
                "newContent": "    public String buildStatsKey(StatsKeyBuilder statsKeyBuilder) {"
            },
            {
                "fromLine": 146,
                "toLine": 146,
                "oldContent": "        StringBuilder strBuilder;",
                "newContent": "        return statsKeyBuilder.buildStatsKey();"
            },
            {
                "fromLine": 147,
                "toLine": 151,
                "oldContent": "        if (topic != null && group != null) {\n            strBuilder = new StringBuilder(topic.length() + group.length() + 6);\n        } else {\n            strBuilder = new StringBuilder();\n        }",
                "newContent": ""
            },
            {
                "fromLine": 152,
                "toLine": 154,
                "oldContent": "        strBuilder.append(queueId).append(\"@\").append(topic).append(\"@\").append(group);\n        return strBuilder.toString();\n    }",
                "newContent": ""
            },
            {
                "fromLine": 156,
                "toLine": 156,
                "oldContent": "    public void incQueuePutNums(final String topic, final Integer queueId) {",
                "newContent": "    public void incQueuePutNums(final StatsKeyBuilder statsKeyBuilder) {"
            },
            {
                "fromLine": 157,
                "toLine": 157,
                "oldContent": "        if (enableQueueStat) {",
                "newContent": "        if (enableQueueStat) {\n            String statsKey = buildStatsKey(statsKeyBuilder);"
            },
            {
                "fromLine": 158,
                "toLine": 158,
                "oldContent": "            this.statsTable.get(Stats.QUEUE_PUT_NUMS).addValue(buildStatsKey(topic, queueId), 1, 1);",
                "newContent": "            this.statsTable.get(Stats.QUEUE_PUT_NUMS).addValue(statsKey, 1, 1);"
            },
            {
                "fromLine": 161,
                "toLine": 161,
                "oldContent": "    public void incQueuePutNums(final String topic, final Integer queueId, int num, int times) {",
                "newContent": "    public void incQueuePutNums(final StatsKeyBuilder statsKeyBuilder, int num, int times) {"
            },
            {
                "fromLine": 162,
                "toLine": 162,
                "oldContent": "        if (enableQueueStat) {",
                "newContent": "        if (enableQueueStat) {\n            String statsKey = buildStatsKey(statsKeyBuilder);"
            },
            {
                "fromLine": 163,
                "toLine": 163,
                "oldContent": "            this.statsTable.get(Stats.QUEUE_PUT_NUMS).addValue(buildStatsKey(topic, queueId), num, times);",
                "newContent": "            this.statsTable.get(Stats.QUEUE_PUT_NUMS).addValue(statsKey, num, times);"
            },
            {
                "fromLine": 166,
                "toLine": 166,
                "oldContent": "    public void incQueuePutSize(final String topic, final Integer queueId, final int size) {",
                "newContent": "    public void incQueuePutSize(final StatsKeyBuilder statsKeyBuilder, final int size) {"
            },
            {
                "fromLine": 167,
                "toLine": 167,
                "oldContent": "        if (enableQueueStat) {",
                "newContent": "        if (enableQueueStat) {\n            String statsKey = buildStatsKey(statsKeyBuilder);"
            },
            {
                "fromLine": 168,
                "toLine": 168,
                "oldContent": "            this.statsTable.get(Stats.QUEUE_PUT_SIZE).addValue(buildStatsKey(topic, queueId), size, 1);",
                "newContent": "            this.statsTable.get(Stats.QUEUE_PUT_SIZE).addValue(statsKey, size, 1);"
            },
            {
                "fromLine": 171,
                "toLine": 171,
                "oldContent": "    public void incQueueGetNums(final String group, final String topic, final Integer queueId, final int incValue) {",
                "newContent": "    public void incQueueGetNums(final StatsKeyBuilder statsKeyBuilder, final int incValue) {"
            },
            {
                "fromLine": 172,
                "toLine": 172,
                "oldContent": "        if (enableQueueStat) {",
                "newContent": "        if (enableQueueStat) {\n            String statsKey = buildStatsKey(statsKeyBuilder);"
            },
            {
                "fromLine": 173,
                "toLine": 173,
                "oldContent": "            final String statsKey = buildStatsKey(topic, queueId, group);",
                "newContent": ""
            },
            {
                "fromLine": 174,
                "toLine": 174,
                "oldContent": "            this.statsTable.get(Stats.QUEUE_GET_NUMS).addValue(statsKey, incValue, 1);",
                "newContent": "            this.statsTable.get(Stats.QUEUE_GET_NUMS).addValue(statsKey, incValue, 1);"
            },
            {
                "fromLine": 177,
                "toLine": 177,
                "oldContent": "    public void incQueueGetSize(final String group, final String topic, final Integer queueId, final int incValue) {",
                "newContent": "    public void incQueueGetSize(final StatsKeyBuilder statsKeyBuilder, final int incValue) {"
            },
            {
                "fromLine": 178,
                "toLine": 178,
                "oldContent": "        if (enableQueueStat) {",
                "newContent": "        if (enableQueueStat) {\n            String statsKey = buildStatsKey(statsKeyBuilder);"
            },
            {
                "fromLine": 179,
                "toLine": 179,
                "oldContent": "            final String statsKey = buildStatsKey(topic, queueId, group);",
                "newContent": ""
            },
            {
                "fromLine": 180,
                "toLine": 180,
                "oldContent": "            this.statsTable.get(Stats.QUEUE_GET_SIZE).addValue(statsKey, incValue, 1);",
                "newContent": "            this.statsTable.get(Stats.QUEUE_GET_SIZE).addValue(statsKey, incValue, 1);"
            },
            {
                "fromLine": 183,
                "toLine": 183,
                "oldContent": "    public void incConsumerRegisterTime(final int incValue) {",
                "newContent": "    public void incConsumerRegisterTime(final StatsKeyBuilder statsKeyBuilder, final int incValue) {"
            },
            {
                "fromLine": 184,
                "toLine": 184,
                "oldContent": "        this.statsTable.get(CONSUMER_REGISTER_TIME).addValue(this.clusterName, incValue, 1);",
                "newContent": "        String statsKey = buildStatsKey(statsKeyBuilder);\n        this.statsTable.get(CONSUMER_REGISTER_TIME).addValue(statsKey, incValue, 1);"
            },
            {
                "fromLine": 187,
                "toLine": 187,
                "oldContent": "    public void incProducerRegisterTime(final int incValue) {",
                "newContent": "    public void incProducerRegisterTime(final StatsKeyBuilder statsKeyBuilder, final int incValue) {"
            },
            {
                "fromLine": 188,
                "toLine": 188,
                "oldContent": "        this.statsTable.get(PRODUCER_REGISTER_TIME).addValue(this.clusterName, incValue, 1);",
                "newContent": "        String statsKey = buildStatsKey(statsKeyBuilder);\n        this.statsTable.get(PRODUCER_REGISTER_TIME).addValue(statsKey, incValue, 1);"
            },
            {
                "fromLine": 191,
                "toLine": 191,
                "oldContent": "    public void incTopicPutNums(final String topic) {",
                "newContent": "    public void incTopicPutNums(final StatsKeyBuilder statsKeyBuilder) {"
            },
            {
                "fromLine": 192,
                "toLine": 192,
                "oldContent": "        this.statsTable.get(Stats.TOPIC_PUT_NUMS).addValue(topic, 1, 1);",
                "newContent": "        String statsKey = buildStatsKey(statsKeyBuilder);\n        this.statsTable.get(Stats.TOPIC_PUT_NUMS).addValue(statsKey, 1, 1);"
            },
            {
                "fromLine": 195,
                "toLine": 195,
                "oldContent": "    public void incTopicPutNums(final String topic, int num, int times) {",
                "newContent": "    public void incTopicPutNums(final StatsKeyBuilder statsKeyBuilder, int num, int times) {"
            },
            {
                "fromLine": 196,
                "toLine": 196,
                "oldContent": "        this.statsTable.get(Stats.TOPIC_PUT_NUMS).addValue(topic, num, times);",
                "newContent": "        String statsKey = buildStatsKey(statsKeyBuilder);\n        this.statsTable.get(Stats.TOPIC_PUT_NUMS).addValue(statsKey, num, times);"
            },
            {
                "fromLine": 199,
                "toLine": 199,
                "oldContent": "    public void incTopicPutSize(final String topic, final int size) {",
                "newContent": "    public void incTopicPutSize(final StatsKeyBuilder statsKeyBuilder, final int size) {"
            },
            {
                "fromLine": 200,
                "toLine": 200,
                "oldContent": "        this.statsTable.get(Stats.TOPIC_PUT_SIZE).addValue(topic, size, 1);",
                "newContent": "        String statsKey = buildStatsKey(statsKeyBuilder);\n        this.statsTable.get(Stats.TOPIC_PUT_SIZE).addValue(statsKey, size, 1);"
            },
            {
                "fromLine": 203,
                "toLine": 203,
                "oldContent": "    public void incGroupGetNums(final String group, final String topic, final int incValue) {",
                "newContent": "    public void incGroupGetNums(final StatsKeyBuilder statsKeyBuilder, final int incValue) {"
            },
            {
                "fromLine": 204,
                "toLine": 204,
                "oldContent": "        final String statsKey = buildStatsKey(topic, group);",
                "newContent": "        String statsKey = buildStatsKey(statsKeyBuilder);"
            },
            {
                "fromLine": 205,
                "toLine": 205,
                "oldContent": "        this.statsTable.get(Stats.GROUP_GET_NUMS).addValue(statsKey, incValue, 1);",
                "newContent": "        this.statsTable.get(Stats.GROUP_GET_NUMS).addValue(statsKey, incValue, 1);"
            },
            {
                "fromLine": 208,
                "toLine": 208,
                "oldContent": "    public void incGroupCkNums(final String group, final String topic, final int incValue) {",
                "newContent": "    public void incGroupCkNums(final StatsKeyBuilder statsKeyBuilder, final int incValue) {"
            },
            {
                "fromLine": 209,
                "toLine": 209,
                "oldContent": "        final String statsKey = buildStatsKey(topic, group);",
                "newContent": "        String statsKey = buildStatsKey(statsKeyBuilder);"
            },
            {
                "fromLine": 210,
                "toLine": 210,
                "oldContent": "        this.statsTable.get(GROUP_CK_NUMS).addValue(statsKey, incValue, 1);",
                "newContent": "        this.statsTable.get(GROUP_CK_NUMS).addValue(statsKey, incValue, 1);"
            },
            {
                "fromLine": 213,
                "toLine": 213,
                "oldContent": "    public void incGroupAckNums(final String group, final String topic, final int incValue) {",
                "newContent": "    public void incGroupAckNums(final StatsKeyBuilder statsKeyBuilder, final int incValue) {"
            },
            {
                "fromLine": 214,
                "toLine": 214,
                "oldContent": "        final String statsKey = buildStatsKey(topic, group);",
                "newContent": "        String statsKey = buildStatsKey(statsKeyBuilder);"
            },
            {
                "fromLine": 215,
                "toLine": 215,
                "oldContent": "        this.statsTable.get(GROUP_ACK_NUMS).addValue(statsKey, incValue, 1);",
                "newContent": "        this.statsTable.get(GROUP_ACK_NUMS).addValue(statsKey, incValue, 1);"
            },
            {
                "fromLine": 218,
                "toLine": 218,
                "oldContent": "    public void incGroupGetSize(final String group, final String topic, final int incValue) {",
                "newContent": "    public void incGroupGetSize(final StatsKeyBuilder statsKeyBuilder, final int incValue) {"
            },
            {
                "fromLine": 219,
                "toLine": 219,
                "oldContent": "        final String statsKey = buildStatsKey(topic, group);",
                "newContent": "        String statsKey = buildStatsKey(statsKeyBuilder);"
            },
            {
                "fromLine": 220,
                "toLine": 220,
                "oldContent": "        this.statsTable.get(Stats.GROUP_GET_SIZE).addValue(statsKey, incValue, 1);",
                "newContent": "        this.statsTable.get(Stats.GROUP_GET_SIZE).addValue(statsKey, incValue, 1);"
            },
            {
                "fromLine": 223,
                "toLine": 223,
                "oldContent": "    public void incGroupGetLatency(final String group, final String topic, final int queueId, final int incValue) {",
                "newContent": "    public void incGroupGetLatency(final StatsKeyBuilder statsKeyBuilder, final int incValue) {"
            },
            {
                "fromLine": 224,
                "toLine": 224,
                "oldContent": "        String statsKey;",

                {
                "fromLine": 224,
                "toLine": 224,
                "oldContent": "        String statsKey;",
                "newContent": "        String statsKey = buildStatsKey(statsKeyBuilder);"
            }
       			            
       		            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            

       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            

       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	            
       	