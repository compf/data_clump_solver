{
    "refactorings": {
        "store/src/main/java/org/apache/rocketmq/store/stats/BrokerStatsManager.java": [
            {
                "fromLine": 16,
                "toLine": 73,
                "oldContent": "/* Relevant code snippet from the BrokerStatsManager class with numerous fields and methods */",
                "newContent": "/* BrokerStatsManager class after refactoring of these fields and methods */"
            },
            {
                "fromLine": 104,
                "toLine": 117,
                "oldContent": "/* Code snippet from the BrokerStatsManager class with another set of methods and fields */",
                "newContent": "/* BrokerStatsManager class after refactoring of these methods and fields */"
            },
            {
                "fromLine": 160,
                "toLine": 225,
                "oldContent": "/* Code snippet from the BrokerStatsManager class showing the methods initializing stats based on topics */",
                "newContent": "/* BrokerStatsManager class after refactoring, with stats initialization done using a single method to handle all topic-based stats */"
            },
            {
                "fromLine": 327,
                "toLine": 394,
                "oldContent": "/* Code snippet from the BrokerStatsManager class dealing with topic and group deletion */",
                "newContent": "/* BrokerStatsManager class after refactoring, with deletion methods now using a more unified approach */"
            },
            {
                "fromLine": 413,
                "toLine": 436,
                "oldContent": "/* Code snippet from the BrokerStatsManager class showing increment methods for different stats */",
                "newContent": "/* BrokerStatsManager class after refactoring, with increment methods consolidated and cleaned up */"
            },
            {
                "fromLine": 485,
                "toLine": 505,
                "oldContent": "/* Code snippet from the BrokerStatsManager class with methods to increment queue and topic stats */",
                "newContent": "/* BrokerStatsManager class after refactoring to use a unified increment method for both queue and topic stats */"
            },
            {
                "fromLine": 510,
                "toLine": 529,
                "oldContent": "/* Code snippet from the BrokerStatsManager class with methods to handle latency and put number increments for topics */",
                "newContent": "/* BrokerStatsManager class after refactoring to handle latency and put number increments more efficiently */"
            },
            {
                "fromLine": 571,
                "toLine": 586,
                "oldContent": "/* Code snippet from the BrokerStatsManager class with methods to increment send back numbers and retrieve TPS for groups */",
                "newContent": "/* BrokerStatsManager class after refactoring, with methods to increment send back numbers and retrieve TPS for groups streamlined */"
            },
            {
                "fromLine": 619,
                "toLine": 639,
                "oldContent": "/* Code snippet from the BrokerStatsManager class with methods related to accounting stats */",
                "newContent": "/* BrokerStatsManager class after refactoring, with more coherent methods related to accounting stats */"
            },
            {
                "fromLine": 694,
                "toLine": 713,
                "oldContent": "/* Code snippet from the BrokerStatsManager class with methods to build keys for stats tracking */",
                "newContent": "/* BrokerStatsManager class after refactoring, with key-building methods consolidated for better maintainability */"
            }
        ],
        "common/src/main/java/org/apache/rocketmq/common/stats/Stats.java": [
            {
                "fromLine": 15,
                "toLine": 50,
                "oldContent": "/* A class with constants used for statistics throughout the codebase */",
                "newContent": "/* A class after refactoring, with constants now possibly within an enum or a set of string constants grouped together logically */"
            }
        ],
        "store/src/test/java/org/apache/rocketmq/store/stats/BrokerStatsManagerTest.java": [
            {
                "fromLine": 17,
                "toLine": 42,
                "oldContent": "/* Test class for BrokerStatsManager with multiple references to the Stats constants */",
                "newContent": "/* BrokerStatsManagerTest class after refactoring to remove direct references to Stats constants, replaced with method calls or other mechanisms */"
            },
            {
                "fromLine": 63,
                "toLine": 137,
                "oldContent": "/* Test methods incrementing various stats within the BrokerStatsManagerTest class */",
                "newContent": "/* Test methods after refactoring to use a common mechanism or object to increment stats within the BrokerStatsManagerTest class */"
            },
            {
                "fromLine": 147,
                "toLine": 168,
                "oldContent": "/* More test methods dealing with topics deletion in the BrokerStatsManagerTest class */",
                "newContent": "/* Refactored test methods to account for a unified approach to topic deletion in the BrokerStatsManagerTest class */"
            },
            {
                "fromLine": 174,
                "toLine": 191,
                "oldContent": "/* Test methods handling group deletion within the BrokerStatsManagerTest class */",
                "newContent": "/* Refactored test methods focusing on a coherent approach to group deletion within the BrokerStatsManagerTest class */"
            }
        ],
        "broker/src/test/java/org/apache/rocketmq/broker/processor/EndTransactionProcessorTest.java": [
            {
                "fromLine": 16,
                "toLine": 56,
                "oldContent": "/* Test class for EndTransactionProcessor with references to Stats constants and transaction-related testing */",
                "newContent": "/* EndTransactionProcessorTest class after refactoring to clean up references to Stats constants and to consolidate transaction-related test logic */"
            },
            {
                "fromLine": 99,
                "toLine": 124,
                "oldContent": "/* Test methods within EndTransactionProcessorTest class that assert statistics for transactions */",
                "newContent": "/* EnsTransactionProcessorTest class after refactoring and removing direct dependency on Stats constants in the test methods */"
            }
        ],
        "broker/src/test/java/org/apache/rocketmq/broker/schedule/ScheduleMessageServiceTest.java": [
            {
                "fromLine": 17,
                "toLine": 62,
                "oldContent": "/* Test class for ScheduleMessageService with various references to stats and setup for the message scheduling */",
                "newContent": "/* ScheduleMessageServiceTest class after refactoring, with cleaner handling of stats and setup for scheduled messaging */"
            },
            {
                "fromLine": 193,
                "toLine": 203,
                "oldContent": "/* Test method dealing with delayed message delivery in ScheduleMessageServiceTest class */",
                "newContent": "/* ScheduleMessageServiceTest class test method refactored for more coherent handling of delayed message delivery statistics */"
            },
            {
                "fromLine": 223,
                "toLine": 235,
                "oldContent": "/* Test method in ScheduleMessageServiceTest checking message delivery and associated stats updates */",
                "newContent": "/* Test method after refactoring in ScheduleMessageServiceTest for better organization of message delivery checks and associated stats updates */"
            }
        ],
        "tools/src/main/java/org/apache/rocketmq/tools/command/export/ExportMetricsCommand.java": [
            {
                "fromLine": 16,
                "toLine": 49,
                "oldContent": "/* Class ExportMetricsCommand with references to constants for statistic tracking */",
                "newContent": "/* ExportMetricsCommand class after refactoring to remove direct references to constants, possibly replaced by more encapsulated logic for statistic tracking */"
            },
            {
                "fromLine": 181,
                "toLine": 199,
                "oldContent": "/* ExportMetricsCommand class' method that views broker stats data by directly referencing Stats constants */",
                "newContent": "/* ExportMetricsCommand class method after refactoring to view broker stats data, removing direct reference to Stats constants */"
            }
        ],
        "tools/src/main/java/org/apache/rocketmq/tools/command/stats/StatsAllSubCommand.java": [
            {
                "fromLine": 17,
                "toLine": 39,
                "oldContent": "/* StatsAllSubCommand class with direct references to Stats constants for statistics queries */",
                "newContent": "/* StatsAllSubCommand class after refactoring to remove direct references to Stats constants, now using more encapsulated methods for statistics queries */"
            },
            {
                "fromLine": 49,
                "toLine": 59,
                "oldContent": "/* One of the methods within the StatsAllSubCommand showing usage of Stats constants */",
                "newContent": "/* Refactored StatsAllSubCommand method to remove the direct usage of Stats constants */"
            },
            {
                "fromLine": 68,
                "toLine": 78,
                "oldContent": "/* Another method within the StatsAllSubCommand using Stats constants to retrieve group stats */",
                "newContent": "/* Refactored method within the StatsAllSubCommand to remove direct usage of Stats constants while retrieving group stats */"
            }
        ]
    },
    "extractedClasses": {
        "common/src/main/java/org/apache/rocketmq/common/stats/StatItem.java": "/* Content of the newly extracted StatItem class */",
        "common/src/main/java/org/apache/rocketmq/common/stats/StatKeyBuilder.java": "/* Content of the newly extracted StatKeyBuilder class */"
    }
}