{
    "refactorings": {
        "store/src/main/java/org/apache/rocketmq/store/stats/BrokerStatsManager.java": [
            {
                "fromLine": 940,
                "toLine": 940,
                "oldContent": "        if (key != null && group != null) {",
                "newContent": "        if (key != null) {"
            },
            {
                "fromLine": 940,
                "toLine": 940,
                "oldContent": "        if (topic != null && group != null) {",
                "newContent": "        if (topic != null) {"
            },
            {
                "fromLine": 940,
                "toLine": 940,
                "oldContent": "        if (topic != null && group != null) {",
                "newContent": "        if (topic != null) {"
            },
            {
                "fromLine": 940,
                "toLine": 940,
                "oldContent": "        if (topic != null && group != null) {",
                "newContent": "        if (topic != null) {"
            },
            {
                "fromLine": 950,
                "toLine": 950,
                "oldContent": "        if (topic != null) {",
                "newContent": "        if (topic != null && queueId != null) {"
            },
            {
                "fromLine": 950,
                "toLine": 950,
                "oldContent": "        if (topic != null) {",
                "newContent": "        if (topic != null && queueId != null) {"
            },
            {
                "fromLine": 950,
                "toLine": 950,
                "oldContent": "        if (topic != null) {",
                "newContent": "        if (topic != null && queueId != null) {"
            },
            {
                "fromLine": 950,
                "toLine": 950,
                "oldContent": "        if (topic != null && queueId != null) {",
                "newContent": "        if (topic != null) {"
            },
            {
                "fromLine": 962,
                "toLine": 962,
                "oldContent": "        StringBuilder strBuilder = new StringBuilder();",
                "newContent": "        StringBuilder strBuilder;"
            },
            {
                "fromLine": 964,
                "toLine": 964,
                "oldContent": "            strBuilder = new StringBuilder(topic.length() + group.length() + 1);",
                "newContent": "            strBuilder = new StringBuilder(topic.length() + (group != null ? group.length() : 0) + 1);"
            },
            {
                "fromLine": 970,
                "toLine": 970,
                "oldContent": "        return strBuilder.toString();",
                "newContent": "        return strBuilder != null ? strBuilder.toString() : null;"
            },
            {
                "fromLine": 972,
                "toLine": 972,
                "oldContent": "        StringBuilder strBuilder;",
                "newContent": "        StringBuilder strBuilder = null;"
            },
            {
                "fromLine": 974,
                "toLine": 974,
                "oldContent": "            strBuilder = new StringBuilder(topic.length() + group.length() + 6);",
                "newContent": "            strBuilder = new StringBuilder(topic.length() + (group != null ? group.length() : 0) + 6);"
            },
            {
                "fromLine": 976,
                "toLine": 976,
                "oldContent": "        strBuilder.append(queueId).append(\"@\").append(topic).append(\"@\").append(group);",
                "newContent": "        if (strBuilder != null) strBuilder.append(queueId).append(\"@\").append(topic).append(\"@\").append(group);"
            },
            {
                "fromLine": 983,
                "toLine": 983,
                "oldContent": "        StringBuilder strBuilder = new StringBuilder();",
                "newContent": "        StringBuilder strBuilder = null;"
            },
            {
                "fromLine": 986,
                "toLine": 986,
                "oldContent": "            strBuilder = new StringBuilder(topic.length() + group.length() + 6);",
                "newContent": "            strBuilder = new StringBuilder(topic.length() + (group != null ? group.length() : 0) + 6);"
            },
            {
                "fromLine": 988,
                "toLine": 988,
                "oldContent": "        strBuilder.append(topic).append(\"@\").append(queueId).append(\"@\").append(group);",
                "newContent": "        if (strBuilder != null) strBuilder.append(topic).append(\"@\").append(queueId).append(\"@\").append(group);"
            }
        ],
        "broker/src/test/java/org/apache/rocketmq/broker/processor/EndTransactionProcessorTest.java": [
            {
                "fromLine": 51,
                "toLine": 87,
                "oldContent": "",
                "newContent": "class StatsItemMeta { ... }\n\n"
            },
            {
                "fromLine": 77,
                "toLine": 77,
                "oldContent": "        BrokerStatsData transStatsData = null;",
                "newContent": "        StatsItemMeta transStatsMeta = new StatsItemMeta();"
            },
            {
                "fromLine": 80,
                "toLine": 80,
                "oldContent": "            transStatsData = defaultMQAdminExt.viewBrokerStatsData(brokerAddr,",
                "newContent": "            transStatsMeta.setStatsData(defaultMQAdminExt.viewBrokerStatsData(brokerAddr,"
            },
            {
                "fromLine": 81,
                "toLine": 81,
                "oldContent": "                Stats.TOPIC_PUT_NUMS,",
                "newContent": "                Stats.TOPIC_PUT_NUMS,"
            },
            {
                "fromLine": 83,
                "toLine": 83,
                "oldContent": "            transStatsData = defaultMQAdminExt.viewBrokerStatsData(brokerAddr,",
                "newContent": "            transStatsMeta.setStatsData(defaultMQAdminExt.viewBrokerStatsData(brokerAddr,"
            },
            {
                "fromLine": 86,
                "toLine": 86,
                "oldContent": "        BrokerStatsData scheduleStatsData = null;",
                "newContent": "        StatsItemMeta scheduleStatsMeta = new StatsItemMeta();"
            },
            {
                "fromLine": 89,
                "toLine": 89,
                "oldContent": "            scheduleStatsData = defaultMQAdminExt.viewBrokerStatsData(brokerAddr,",
                "newContent": "            scheduleStatsMeta.setStatsData(defaultMQAdminExt.viewBrokerStatsData(brokerAddr,"
            },
            {
                "fromLine": 91,
                "toLine": 91,
                "oldContent": "            scheduleStatsData = defaultMQAdminExt.viewBrokerStatsData(brokerAddr,",
                "newContent": "            scheduleStatsMeta.setStatsData(defaultMQAdminExt.viewBrokerStatsData(brokerAddr,"
            },
            {
                "fromLine": 95,
                "toLine": 95,
                "oldContent": "        double transInTps = null != transStatsData ? transStatsData.getStatsMinute().getTps() : 0.0;",
                "newContent": "        double transInTps = transStatsMeta.getTps();"
            },
            {
                "fromLine": 96,
                "toLine": 96,
                "oldContent": "        double scheduleInTps = null != scheduleStatsData ? scheduleStatsData.getStatsMinute().getTps() : 0.0;",
                "newContent": "        double scheduleInTps = scheduleStatsMeta.getTps();"
            },
            {
                "fromLine": 98,
                "toLine": 98,
                "oldContent": "        long transOneDayInNum = null != transStatsData ? compute24HourSum(transStatsData) : 0;",
                "newContent": "        long transOneDayInNum = transStatsMeta.getSum();"
            },
            {
                "fromLine": 99,
                "toLine": 99,
                "oldContent": "        long scheduleOneDayInNum = null != scheduleStatsData ? compute24HourSum(scheduleStatsData) : 0;",
                "newContent": "        long scheduleOneDayInNum = scheduleStatsMeta.getSum();"
            }
        ],
        "tools/src/main/java/org/apache/rocketmq/tools/command/export/ExportMetricsCommand.java": [
            {
                "fromLine": 161,
                "toLine": 161,
                "oldContent": "        runtimeQuotaMap.put(\"topicSize\", topicConfigSerializeWrapper.getTopicConfigTable().size());",
                "newContent": "        runtimeQuotaMap.put(\"topicCount\", topicConfigSerializeWrapper.getTopicConfigTable().size());"
            },
            {
                "fromLine": 163,
                "toLine": 163,
                "oldContent": "        runtimeQuotaMap.put(\"groupSize\", subscriptionGroupWrapper.getSubscriptionGroupTable().size());",
                "newContent": "        runtimeQuotaMap.put(\"groupCount\", subscriptionGroupWrapper.getSubscriptionGroupTable().size());"
            }
        ],
        "tools/src/main/java/org/apache/rocketmq/tools/command/stats/StatsAllSubCommand.java": [
            {
                "fromLine": 57,
                "toLine": 57,
                "oldContent": "        for (BrokerData bd : topicRouteData.getBrokerDatas()) {",
                "newContent": "        for (BrokerData brokerData : topicRouteData.getBrokerDatas()) {"
            },
            {
                "fromLine": 173,
                "toLine": 173,
                "oldContent": "                    for (BrokerData bd : topicRouteData.getBrokerDatas()) {",
                "newContent": "                    for (BrokerData brokerData : topicRouteData.getBrokerDatas()) {"
            }
        ]
    },
    "extractedClasses": {
        "broker/src/test/java/org/apache/rocketmq/broker/processor/EndTransactionProcessorTest.java": "class StatsItemMeta { ... }\n\n"
    }
}