{
    "refactorings": {
        "broker/src/main/java/org/apache/rocketmq/broker/metrics/ConsumerLagCalculator.java": [
            {
                "fromLine": 279,
                "toLine": 289,
                "oldContent": "        return brokerStatHelper.getConsumerLagStats(group, topic, isPop);\n        TopicConfig topicConfig = topicConfigManager.selectTopicConfig(topic);\n        ... // The rest of the original method content",
                "newContent": ""
            },
            {
                "fromLine": 306,
                "toLine": 322,
                "oldContent": "        return brokerStatHelper.getConsumerLagStats(group, topic, queueId, isPop);\n        long brokerOffset = messageStore.getMaxOffsetInQueue(topic, queueId);\n        ... // The rest of the original method content",
                "newContent": ""
            },
            {
                "fromLine": 338,
                "toLine": 348,
                "oldContent": "        return brokerStatHelper.getInFlightMsgStats(group, topic, isPop);\n        long total = 0L;\n        long earliestUnPulledTimestamp = Long.MAX_VALUE;\n        ... // The rest of the original method content",
                "newContent": ""
            },
            {
                "fromLine": 365,
                "toLine": 381,
                "oldContent": "        return brokerStatHelper.getInFlightMsgStats(group, topic, queueId, isPop);\n        if (isPop) {\n            long inflight = popInflightMessageCounter.getGroupPopInFlightMessageNum(topic, group, queueId);\n            long pullOffset = popBufferMergeService.getLatestOffset(topic, group, queueId);\n            ... // The rest of the original method content",
                "newContent": ""
            },
            {
                "fromLine": 395,
                "toLine": 403,
                "oldContent": "        return brokerStatHelper.getAvailableMsgCount(group, topic, isPop);\n        long total = 0L;\n\n        if (group == null || topic == null) {\n            return total;\n        }\n        ... // The rest of the original method content",
                "newContent": ""
            },
            {
                "fromLine": 415,
                "toLine": 421,
                "oldContent": "        return brokerStatHelper.getAvailableMsgCount(group, topic, queueId, isPop);\n        long brokerOffset = messageStore.getMaxOffsetInQueue(topic, queueId);\n        if (brokerOffset < 0) {\n            brokerOffset = 0;\n        }\n        ... // The rest of the original method content",
                "newContent": ""
            },
            {
                "fromLine": 441,
                "toLine": 443,
                "oldContent": "        return brokerStatHelper.getStoreTimeStamp(topic, queueId, offset);\n        long storeTimeStamp = Long.MAX_VALUE;\n        if (offset >= 0) {\n            ... // The rest of the original method content",
                "newContent": ""
            },
            {
                "fromLine": 451,
                "toLine": 471,
                "oldContent": "        return brokerStatHelper.calculateMessageCount(group, topic, queueId, from, to);\n        long count = to - from;\n\n        if (brokerConfig.isEstimateAccumulation() && to > from) {\n            ... // The rest of the original method content",
                "newContent": ""
            }
        ]
    },
    "extractedClasses": {
        "broker/src/main/java/org/apache/rocketmq/broker/metrics/BrokerStatHelper.java": "package org.apache.rocketmq.broker.metrics;\n\npublic class BrokerStatHelper {\n    // This class contains refactored methods from ConsumerLagCalculator\n    // Methods should match the ones called in ConsumerLagCalculator\n}\n"
    }
}