{
    "messages": [
        {
            "content": "\nI will provide you one or more Java code files .\nFind all data clumps in the respective files.\n\nA data clump exists if\n1) two methods (in the same or in different classes) have at least 3 common parameters\n    and one of those methods does not override the other,\n\nor  \n2) At least three fields in a class are common with the parameters of a method (in the same or in a different class),\n\nor\n3) Two different classes have at least three common fields\n\n## OUTPUT FORMAT\nUse the following JSON format for the output:\n\n{\n   \"data_clumps\":{\n        \"unique_key\":{\n            \"key\": \"a unique key that should be created. It must be same as the key 'unique_key' in the 'data_clumps' object\",\n            \"from_file_path\":\"The path of the file where one part of the data clump is found\",\n            \"from_class_or_interface_key\":\"The fully qualified name of the class or interface where one part of the data clump is found\",\n            \"from_class_or_interface_name\":\"The name of the class or interface where one part of the data clump is found\",\n            \n            \"from_method_key\":\"The fully qualified name of the method where one part of the data clump is found. It may be 'null' if the data clump on this part is not found in a method\",\n            \"from_method_name\":\"The name of the method where one part of the data clump is found. It may be 'null' if the data clump on this part is not found in a method\",\n\n            \"to_file_path\":\"The path of the file where the  other part of the data clump is found\",\n            \"to_class_or_interface_key\":\"The fully qualified name of the class or interface where the  other part part of the data clump is found\",\n            \"to_class_or_interface_name\":\"The name of the class or interface where the  other  part of the data clump is found\",\n            \n            \"to_method_key\":\"The fully qualified name of the method where the  other part part of the data clump is found. It may be 'null' if the data clump on this part is not found in a method\",\n            \"to_method_name\":\"The name of the method where the  other  part of the data clump is found. It may be 'null' if the data clump on this part is not found in a method\",\n            \"data_clump_data\":{\n                // for each data clump variable\n                \"other_unique_key\":{\n                    \"key\":\"a unique key that should be created. It must be same as the key 'other_unique_key' in the 'data_clump_data' object\",\n                    \"name\": \"The name of the data clump variable that exists on the one part of the data clump\",\n                    \"type\": \"The type of the data clump variable that exists on the one part of the data clump\",\n                    \"displayedType\": \"The  type of the data clump variable, as it appears in the source code, that exists on the one part of the data clump\",\n                    \n                    \"position\": {\n                        \"startLine\": \"The line number of the  data clump variable on the one part of the data clump.This must be relative to the file\",\n                        \"startColumn\": \"The column number of the data clump variable on the one part of the data clump\"\n                    },\n                    \"to_variable\":{\n                        \"key\":\"a unique key that should be created.\",\n                        \"name\": \"The name of the data clump variable that exists on the other part of the data clump\",\n                        \"type\": \"The type of the data clump variable, as it appears in the source code, that exists on the other part of the data clump\",\n                        \"position\": {\n                            \"startLine\": \"The line number of the  data clump variable on the other part of the data clump. This must be relative to the file\",\n                            \"startColumn\": \"The column number of the data clump variable on the other part of the data clump\",\n                        }\n                    }\n                }\n            }\n        }\n   }\n}\n\n## END OUTPUT FORMAT\n",
            "role": "system"
        },
        {
            "content": "{\"common/src/main/java/org/apache/rocketmq/common/stats/Stats.java\":[{\"fromLine\":16,\"toLine\":18,\"content\":\" */\\npackage org.apache.rocketmq.common.stats;\\n\"},{\"fromLine\":21,\"toLine\":42,\"content\":\"    public static final String QUEUE_PUT_NUMS = \\\"QUEUE_PUT_NUMS\\\";\\n    public static final String QUEUE_PUT_SIZE = \\\"QUEUE_PUT_SIZE\\\";\\n    public static final String QUEUE_GET_NUMS = \\\"QUEUE_GET_NUMS\\\";\\n    public static final String QUEUE_GET_SIZE = \\\"QUEUE_GET_SIZE\\\";\\n    public static final String TOPIC_PUT_NUMS = \\\"TOPIC_PUT_NUMS\\\";\\n    public static final String TOPIC_PUT_SIZE = \\\"TOPIC_PUT_SIZE\\\";\\n    public static final String GROUP_GET_NUMS = \\\"GROUP_GET_NUMS\\\";\\n    public static final String GROUP_GET_SIZE = \\\"GROUP_GET_SIZE\\\";\\n    public static final String SNDBCK_PUT_NUMS = \\\"SNDBCK_PUT_NUMS\\\";\\n    public static final String BROKER_PUT_NUMS = \\\"BROKER_PUT_NUMS\\\";\\n    public static final String BROKER_GET_NUMS = \\\"BROKER_GET_NUMS\\\";\\n    public static final String GROUP_GET_FROM_DISK_NUMS = \\\"GROUP_GET_FROM_DISK_NUMS\\\";\\n    public static final String GROUP_GET_FROM_DISK_SIZE = \\\"GROUP_GET_FROM_DISK_SIZE\\\";\\n    public static final String BROKER_GET_FROM_DISK_NUMS = \\\"BROKER_GET_FROM_DISK_NUMS\\\";\\n    public static final String BROKER_GET_FROM_DISK_SIZE = \\\"BROKER_GET_FROM_DISK_SIZE\\\";\\n    public static final String COMMERCIAL_SEND_TIMES = \\\"COMMERCIAL_SEND_TIMES\\\";\\n    public static final String COMMERCIAL_SNDBCK_TIMES = \\\"COMMERCIAL_SNDBCK_TIMES\\\";\\n    public static final String COMMERCIAL_RCV_TIMES = \\\"COMMERCIAL_RCV_TIMES\\\";\\n    public static final String COMMERCIAL_RCV_EPOLLS = \\\"COMMERCIAL_RCV_EPOLLS\\\";\\n    public static final String COMMERCIAL_SEND_SIZE = \\\"COMMERCIAL_SEND_SIZE\\\";\\n    public static final String COMMERCIAL_RCV_SIZE = \\\"COMMERCIAL_RCV_SIZE\\\";\\n    public static final String COMMERCIAL_PERM_FAILURES = \\\"COMMERCIAL_PERM_FAILURES\\\";\"},{\"fromLine\":44,\"toLine\":46,\"content\":\"    public static final String GROUP_GET_FALL_SIZE = \\\"GROUP_GET_FALL_SIZE\\\";\\n    public static final String GROUP_GET_FALL_TIME = \\\"GROUP_GET_FALL_TIME\\\";\\n    public static final String GROUP_GET_LATENCY = \\\"GROUP_GET_LATENCY\\\";\"}],\"store/src/main/java/org/apache/rocketmq/store/stats/BrokerStatsManager.java\":[{\"fromLine\":16,\"toLine\":42,\"content\":\" */\\npackage org.apache.rocketmq.store.stats;\\n\\nimport java.util.HashMap;\\nimport java.util.concurrent.ScheduledExecutorService;\\nimport org.apache.commons.lang3.tuple.Pair;\\nimport org.apache.rocketmq.common.BrokerConfig;\\nimport org.apache.rocketmq.common.ThreadFactoryImpl;\\nimport org.apache.rocketmq.common.UtilAll;\\nimport org.apache.rocketmq.common.constant.LoggerName;\\nimport org.apache.rocketmq.common.statistics.StatisticsItem;\\nimport org.apache.rocketmq.common.statistics.StatisticsItemFormatter;\\nimport org.apache.rocketmq.common.statistics.StatisticsItemPrinter;\\nimport org.apache.rocketmq.common.statistics.StatisticsItemScheduledIncrementPrinter;\\nimport org.apache.rocketmq.common.statistics.StatisticsItemScheduledPrinter;\\nimport org.apache.rocketmq.common.statistics.StatisticsItemStateGetter;\\nimport org.apache.rocketmq.common.statistics.StatisticsKindMeta;\\nimport org.apache.rocketmq.common.statistics.StatisticsManager;\\nimport org.apache.rocketmq.common.stats.MomentStatsItemSet;\\nimport org.apache.rocketmq.common.stats.Stats;\\nimport org.apache.rocketmq.common.stats.StatsItem;\\nimport org.apache.rocketmq.common.stats.StatsItemSet;\\nimport org.apache.rocketmq.common.topic.TopicValidator;\\nimport org.apache.rocketmq.common.utils.ThreadUtils;\\nimport org.apache.rocketmq.logging.org.slf4j.Logger;\\nimport org.apache.rocketmq.logging.org.slf4j.LoggerFactory;\\n\"},{\"fromLine\":45,\"toLine\":50,\"content\":\"    @Deprecated public static final String QUEUE_PUT_NUMS = Stats.QUEUE_PUT_NUMS;\\n    @Deprecated public static final String QUEUE_PUT_SIZE = Stats.QUEUE_PUT_SIZE;\\n    @Deprecated public static final String QUEUE_GET_NUMS = Stats.QUEUE_GET_NUMS;\\n    @Deprecated public static final String QUEUE_GET_SIZE = Stats.QUEUE_GET_SIZE;\\n    @Deprecated public static final String TOPIC_PUT_NUMS = Stats.TOPIC_PUT_NUMS;\\n    @Deprecated public static final String TOPIC_PUT_SIZE = Stats.TOPIC_PUT_SIZE;\"},{\"fromLine\":52,\"toLine\":53,\"content\":\"    @Deprecated public static final String GROUP_GET_NUMS = Stats.GROUP_GET_NUMS;\\n    @Deprecated public static final String GROUP_GET_SIZE = Stats.GROUP_GET_SIZE;\"},{\"fromLine\":55,\"toLine\":61,\"content\":\"    @Deprecated public static final String SNDBCK_PUT_NUMS = Stats.SNDBCK_PUT_NUMS;\\n    @Deprecated public static final String BROKER_PUT_NUMS = Stats.BROKER_PUT_NUMS;\\n    @Deprecated public static final String BROKER_GET_NUMS = Stats.BROKER_GET_NUMS;\\n    @Deprecated public static final String GROUP_GET_FROM_DISK_NUMS = Stats.GROUP_GET_FROM_DISK_NUMS;\\n    @Deprecated public static final String GROUP_GET_FROM_DISK_SIZE = Stats.GROUP_GET_FROM_DISK_SIZE;\\n    @Deprecated public static final String BROKER_GET_FROM_DISK_NUMS = Stats.BROKER_GET_FROM_DISK_NUMS;\\n    @Deprecated public static final String BROKER_GET_FROM_DISK_SIZE = Stats.BROKER_GET_FROM_DISK_SIZE;\"},{\"fromLine\":63,\"toLine\":69,\"content\":\"    @Deprecated public static final String COMMERCIAL_SEND_TIMES = Stats.COMMERCIAL_SEND_TIMES;\\n    @Deprecated public static final String COMMERCIAL_SNDBCK_TIMES = Stats.COMMERCIAL_SNDBCK_TIMES;\\n    @Deprecated public static final String COMMERCIAL_RCV_TIMES = Stats.COMMERCIAL_RCV_TIMES;\\n    @Deprecated public static final String COMMERCIAL_RCV_EPOLLS = Stats.COMMERCIAL_RCV_EPOLLS;\\n    @Deprecated public static final String COMMERCIAL_SEND_SIZE = Stats.COMMERCIAL_SEND_SIZE;\\n    @Deprecated public static final String COMMERCIAL_RCV_SIZE = Stats.COMMERCIAL_RCV_SIZE;\\n    @Deprecated public static final String COMMERCIAL_PERM_FAILURES = Stats.COMMERCIAL_PERM_FAILURES;\"},{\"fromLine\":72,\"toLine\":80,\"content\":\"    public static final String TOPIC_PUT_LATENCY = \\\"TOPIC_PUT_LATENCY\\\";\\n    public static final String GROUP_ACK_NUMS = \\\"GROUP_ACK_NUMS\\\";\\n    public static final String GROUP_CK_NUMS = \\\"GROUP_CK_NUMS\\\";\\n    public static final String DLQ_PUT_NUMS = \\\"DLQ_PUT_NUMS\\\";\\n    public static final String BROKER_ACK_NUMS = \\\"BROKER_ACK_NUMS\\\";\\n    public static final String BROKER_CK_NUMS = \\\"BROKER_CK_NUMS\\\";\\n    public static final String BROKER_GET_NUMS_WITHOUT_SYSTEM_TOPIC = \\\"BROKER_GET_NUMS_WITHOUT_SYSTEM_TOPIC\\\";\\n    public static final String BROKER_PUT_NUMS_WITHOUT_SYSTEM_TOPIC = \\\"BROKER_PUT_NUMS_WITHOUT_SYSTEM_TOPIC\\\";\\n    public static final String SNDBCK2DLQ_TIMES = \\\"SNDBCK2DLQ_TIMES\\\";\"},{\"fromLine\":82,\"toLine\":82,\"content\":\"    public static final String COMMERCIAL_OWNER = \\\"Owner\\\";\"},{\"fromLine\":84,\"toLine\":85,\"content\":\"    public static final String ACCOUNT_OWNER_PARENT = \\\"OWNER_PARENT\\\";\\n    public static final String ACCOUNT_OWNER_SELF = \\\"OWNER_SELF\\\";\"},{\"fromLine\":87,\"toLine\":88,\"content\":\"    public static final long ACCOUNT_STAT_INVERTAL = 60 * 1000;\\n    public static final String ACCOUNT_AUTH_TYPE = \\\"AUTH_TYPE\\\";\"},{\"fromLine\":90,\"toLine\":96,\"content\":\"    public static final String ACCOUNT_SEND = \\\"SEND\\\";\\n    public static final String ACCOUNT_RCV = \\\"RCV\\\";\\n    public static final String ACCOUNT_SEND_BACK = \\\"SEND_BACK\\\";\\n    public static final String ACCOUNT_SEND_BACK_TO_DLQ = \\\"SEND_BACK_TO_DLQ\\\";\\n    public static final String ACCOUNT_AUTH_FAILED = \\\"AUTH_FAILED\\\";\\n    public static final String ACCOUNT_SEND_REJ = \\\"SEND_REJ\\\";\\n    public static final String ACCOUNT_REV_REJ = \\\"RCV_REJ\\\";\"},{\"fromLine\":98,\"toLine\":108,\"content\":\"    public static final String MSG_NUM = \\\"MSG_NUM\\\";\\n    public static final String MSG_SIZE = \\\"MSG_SIZE\\\";\\n    public static final String SUCCESS_MSG_NUM = \\\"SUCCESS_MSG_NUM\\\";\\n    public static final String FAILURE_MSG_NUM = \\\"FAILURE_MSG_NUM\\\";\\n    public static final String COMMERCIAL_MSG_NUM = \\\"COMMERCIAL_MSG_NUM\\\";\\n    public static final String SUCCESS_REQ_NUM = \\\"SUCCESS_REQ_NUM\\\";\\n    public static final String FAILURE_REQ_NUM = \\\"FAILURE_REQ_NUM\\\";\\n    public static final String SUCCESS_MSG_SIZE = \\\"SUCCESS_MSG_SIZE\\\";\\n    public static final String FAILURE_MSG_SIZE = \\\"FAILURE_MSG_SIZE\\\";\\n    public static final String RT = \\\"RT\\\";\\n    public static final String INNER_RT = \\\"INNER_RT\\\";\"},{\"fromLine\":110,\"toLine\":111,\"content\":\"    @Deprecated public static final String GROUP_GET_FALL_SIZE = Stats.GROUP_GET_FALL_SIZE;\\n    @Deprecated public static final String GROUP_GET_FALL_TIME = Stats.GROUP_GET_FALL_TIME;\"},{\"fromLine\":113,\"toLine\":113,\"content\":\"    @Deprecated public static final String GROUP_GET_LATENCY = Stats.GROUP_GET_LATENCY;\"},{\"fromLine\":116,\"toLine\":116,\"content\":\"    public static final String CONSUMER_REGISTER_TIME = \\\"CONSUMER_REGISTER_TIME\\\";\"},{\"fromLine\":118,\"toLine\":123,\"content\":\"    public static final String PRODUCER_REGISTER_TIME = \\\"PRODUCER_REGISTER_TIME\\\";\\n    public static final String CHANNEL_ACTIVITY = \\\"CHANNEL_ACTIVITY\\\";\\n    public static final String CHANNEL_ACTIVITY_CONNECT = \\\"CONNECT\\\";\\n    public static final String CHANNEL_ACTIVITY_IDLE = \\\"IDLE\\\";\\n    public static final String CHANNEL_ACTIVITY_EXCEPTION = \\\"EXCEPTION\\\";\\n    public static final String CHANNEL_ACTIVITY_CLOSE = \\\"CLOSE\\\";\"},{\"fromLine\":128,\"toLine\":129,\"content\":\"    private static final Logger log = LoggerFactory.getLogger(LoggerName.ROCKETMQ_STATS_LOGGER_NAME);\\n    private static final Logger COMMERCIAL_LOG = LoggerFactory.getLogger(\"},{\"fromLine\":131,\"toLine\":132,\"content\":\"    private static final Logger ACCOUNT_LOG = LoggerFactory.getLogger(LoggerName.ACCOUNT_LOGGER_NAME);\\n    private static final Logger DLQ_STAT_LOG = LoggerFactory.getLogger(\"},{\"fromLine\":134,\"toLine\":136,\"content\":\"    private ScheduledExecutorService scheduledExecutorService;\\n    private ScheduledExecutorService commercialExecutor;\\n    private ScheduledExecutorService accountExecutor;\"},{\"fromLine\":138,\"toLine\":142,\"content\":\"    private final HashMap<String, StatsItemSet> statsTable = new HashMap<>();\\n    private final String clusterName;\\n    private final boolean enableQueueStat;\\n    private MomentStatsItemSet momentStatsItemSetFallSize;\\n    private MomentStatsItemSet momentStatsItemSetFallTime;\"},{\"fromLine\":144,\"toLine\":146,\"content\":\"    private final StatisticsManager accountStatManager = new StatisticsManager();\\n    private StateGetter producerStateGetter;\\n    private StateGetter consumerStateGetter;\"},{\"fromLine\":148,\"toLine\":148,\"content\":\"    private BrokerConfig brokerConfig;\"},{\"fromLine\":368,\"toLine\":368,\"content\":\"    public void incQueuePutNums(final String topic, final Integer queueId, int num, int times) {\"},{\"fromLine\":374,\"toLine\":374,\"content\":\"    public void incQueuePutSize(final String topic, final Integer queueId, final int size) {\"},{\"fromLine\":380,\"toLine\":380,\"content\":\"    public void incQueueGetNums(final String group, final String topic, final Integer queueId, final int incValue) {\"},{\"fromLine\":387,\"toLine\":387,\"content\":\"    public void incQueueGetSize(final String group, final String topic, final Integer queueId, final int incValue) {\"},{\"fromLine\":422,\"toLine\":422,\"content\":\"    public void incTopicPutNums(final String topic, int num, int times) {\"},{\"fromLine\":430,\"toLine\":430,\"content\":\"    public void incGroupGetNums(final String group, final String topic, final int incValue) {\"},{\"fromLine\":435,\"toLine\":435,\"content\":\"    public void incGroupCkNums(final String group, final String topic, final int incValue) {\"},{\"fromLine\":440,\"toLine\":440,\"content\":\"    public void incGroupAckNums(final String group, final String topic, final int incValue) {\"},{\"fromLine\":467,\"toLine\":467,\"content\":\"    public String buildStatsKey(String topic, int queueId, String group) {\"},{\"fromLine\":478,\"toLine\":478,\"content\":\"    public String buildStatsKey(int queueId, String topic, String group) {\"},{\"fromLine\":489,\"toLine\":489,\"content\":\"    public void incGroupGetSize(final String group, final String topic, final int incValue) {\"},{\"fromLine\":494,\"toLine\":494,\"content\":\"    public void incGroupGetLatency(final String group, final String topic, final int queueId, final int incValue) {\"},{\"fromLine\":504,\"toLine\":504,\"content\":\"    public void incTopicPutLatency(final String topic, final int queueId, final int incValue) {\"},{\"fromLine\":585,\"toLine\":586,\"content\":\"    public void recordDiskFallBehindTime(final String group, final String topic, final int queueId,\\n        final long fallBehind) {\"},{\"fromLine\":591,\"toLine\":592,\"content\":\"    public void recordDiskFallBehindSize(final String group, final String topic, final int queueId,\\n        final long fallBehind) {\"},{\"fromLine\":597,\"toLine\":598,\"content\":\"    public void incDLQStatValue(final String key, final String owner, final String group,\\n        final String topic, final String type, final int incValue) {\"},{\"fromLine\":603,\"toLine\":604,\"content\":\"    public void incCommercialValue(final String key, final String owner, final String group,\\n        final String topic, final String type, final int incValue) {\"},{\"fromLine\":609,\"toLine\":611,\"content\":\"    public void incAccountValue(final String key, final String accountOwnerParent, final String accountOwnerSelf,\\n        final String instanceId, final String group, final String topic,\\n        final String msgType, final int incValue) {\"},{\"fromLine\":617,\"toLine\":619,\"content\":\"    public void incAccountValue(final String key, final String accountOwnerParent, final String accountOwnerSelf,\\n        final String instanceId, final String group, final String topic,\\n        final String msgType, final String flowlimitThreshold, final int incValue) {\"},{\"fromLine\":625,\"toLine\":627,\"content\":\"    public void incAccountValue(final String statType, final String owner, final String instanceId, final String topic,\\n        final String group, final String msgType,\\n        final long... incValues) {\"},{\"fromLine\":632,\"toLine\":634,\"content\":\"    public void incAccountValue(final String statType, final String owner, final String instanceId, final String topic,\\n        final String group, final String msgType, final String flowlimitThreshold,\\n        final long... incValues) {\"},{\"fromLine\":639,\"toLine\":639,\"content\":\"    public String buildCommercialStatsKey(String owner, String topic, String group, String type) {\"},{\"fromLine\":651,\"toLine\":652,\"content\":\"    public String buildAccountStatsKey(String accountOwnerParent, String accountOwnerSelf, String instanceId,\\n        String topic, String group, String msgType) {\"},{\"fromLine\":668,\"toLine\":669,\"content\":\"    public String buildAccountStatsKey(String accountOwnerParent, String accountOwnerSelf, String instanceId,\\n        String topic, String group, String msgType, String flowlimitThreshold) {\"},{\"fromLine\":687,\"toLine\":689,\"content\":\"    public String buildAccountStatKey(final String owner, final String instanceId,\\n        final String topic, final String group,\\n        final String msgType) {\"},{\"fromLine\":700,\"toLine\":702,\"content\":\"    public String buildAccountStatKey(final String owner, final String instanceId,\\n        final String topic, final String group,\\n        final String msgType, String flowlimitThreshold) {\"},{\"fromLine\":719,\"toLine\":724,\"content\":\"    private StatisticsKindMeta createStatisticsKindMeta(String name,\\n        String[] itemNames,\\n        ScheduledExecutorService executorService,\\n        StatisticsItemFormatter formatter,\\n        Logger log,\\n        long interval) {\"}],\"client/src/main/java/org/apache/rocketmq/client/impl/consumer/DefaultLitePullConsumerImpl.java\":[{\"fromLine\":16,\"toLine\":78,\"content\":\" */\\npackage org.apache.rocketmq.client.impl.consumer;\\n\\nimport java.util.ArrayList;\\nimport java.util.Collection;\\nimport java.util.Collections;\\nimport java.util.HashMap;\\nimport java.util.HashSet;\\nimport java.util.Iterator;\\nimport java.util.List;\\nimport java.util.Map;\\nimport java.util.Properties;\\nimport java.util.Set;\\nimport java.util.concurrent.BlockingQueue;\\nimport java.util.concurrent.ConcurrentHashMap;\\nimport java.util.concurrent.ConcurrentMap;\\nimport java.util.concurrent.Executors;\\nimport java.util.concurrent.LinkedBlockingQueue;\\nimport java.util.concurrent.ScheduledExecutorService;\\nimport java.util.concurrent.ScheduledThreadPoolExecutor;\\nimport java.util.concurrent.TimeUnit;\\nimport org.apache.commons.lang3.StringUtils;\\nimport org.apache.rocketmq.client.Validators;\\nimport org.apache.rocketmq.client.consumer.DefaultLitePullConsumer;\\nimport org.apache.rocketmq.client.consumer.MessageQueueListener;\\nimport org.apache.rocketmq.client.consumer.MessageSelector;\\nimport org.apache.rocketmq.client.consumer.PullResult;\\nimport org.apache.rocketmq.client.consumer.TopicMessageQueueChangeListener;\\nimport org.apache.rocketmq.client.consumer.listener.ConsumeConcurrentlyStatus;\\nimport org.apache.rocketmq.client.consumer.store.LocalFileOffsetStore;\\nimport org.apache.rocketmq.client.consumer.store.OffsetStore;\\nimport org.apache.rocketmq.client.consumer.store.ReadOffsetType;\\nimport org.apache.rocketmq.client.consumer.store.RemoteBrokerOffsetStore;\\nimport org.apache.rocketmq.client.exception.MQBrokerException;\\nimport org.apache.rocketmq.client.exception.MQClientException;\\nimport org.apache.rocketmq.client.hook.ConsumeMessageContext;\\nimport org.apache.rocketmq.client.hook.ConsumeMessageHook;\\nimport org.apache.rocketmq.client.hook.FilterMessageHook;\\nimport org.apache.rocketmq.client.impl.CommunicationMode;\\nimport org.apache.rocketmq.client.impl.MQClientManager;\\nimport org.apache.rocketmq.client.impl.factory.MQClientInstance;\\nimport org.apache.rocketmq.common.MixAll;\\nimport org.apache.rocketmq.common.ServiceState;\\nimport org.apache.rocketmq.common.ThreadFactoryImpl;\\nimport org.apache.rocketmq.common.consumer.ConsumeFromWhere;\\nimport org.apache.rocketmq.common.filter.ExpressionType;\\nimport org.apache.rocketmq.common.help.FAQUrl;\\nimport org.apache.rocketmq.common.message.MessageExt;\\nimport org.apache.rocketmq.common.message.MessageQueue;\\nimport org.apache.rocketmq.common.sysflag.PullSysFlag;\\nimport org.apache.rocketmq.remoting.RPCHook;\\nimport org.apache.rocketmq.remoting.exception.RemotingException;\\nimport org.apache.rocketmq.remoting.protocol.NamespaceUtil;\\nimport org.apache.rocketmq.remoting.protocol.ResponseCode;\\nimport org.apache.rocketmq.remoting.protocol.body.ConsumerRunningInfo;\\nimport org.apache.rocketmq.remoting.protocol.body.ProcessQueueInfo;\\nimport org.apache.rocketmq.remoting.protocol.filter.FilterAPI;\\nimport org.apache.rocketmq.remoting.protocol.heartbeat.ConsumeType;\\nimport org.apache.rocketmq.remoting.protocol.heartbeat.MessageModel;\\nimport org.apache.rocketmq.remoting.protocol.heartbeat.SubscriptionData;\\nimport org.apache.rocketmq.logging.org.slf4j.Logger;\\nimport org.apache.rocketmq.logging.org.slf4j.LoggerFactory;\\n\"},{\"fromLine\":81,\"toLine\":81,\"content\":\"    private static final Logger log = LoggerFactory.getLogger(DefaultLitePullConsumerImpl.class);\"},{\"fromLine\":83,\"toLine\":83,\"content\":\"    private final long consumerStartTimestamp = System.currentTimeMillis();\"},{\"fromLine\":85,\"toLine\":85,\"content\":\"    private final RPCHook rpcHook;\"},{\"fromLine\":87,\"toLine\":87,\"content\":\"    private final ArrayList<FilterMessageHook> filterMessageHookList = new ArrayList<>();\"},{\"fromLine\":89,\"toLine\":89,\"content\":\"    private volatile ServiceState serviceState = ServiceState.CREATE_JUST;\"},{\"fromLine\":91,\"toLine\":91,\"content\":\"    protected MQClientInstance mQClientFactory;\"},{\"fromLine\":93,\"toLine\":93,\"content\":\"    private PullAPIWrapper pullAPIWrapper;\"},{\"fromLine\":95,\"toLine\":95,\"content\":\"    private OffsetStore offsetStore;\"},{\"fromLine\":97,\"toLine\":97,\"content\":\"    private RebalanceImpl rebalanceImpl = new RebalanceLitePullImpl(this);\"},{\"fromLine\":103,\"toLine\":103,\"content\":\"    private static final String NOT_RUNNING_EXCEPTION_MESSAGE = \\\"The consumer not running, please start it first.\\\";\"},{\"fromLine\":105,\"toLine\":105,\"content\":\"    private static final String SUBSCRIPTION_CONFLICT_EXCEPTION_MESSAGE = \\\"Subscribe and assign are mutually exclusive.\\\";\"},{\"fromLine\":109,\"toLine\":109,\"content\":\"    private SubscriptionType subscriptionType = SubscriptionType.NONE;\"},{\"fromLine\":113,\"toLine\":113,\"content\":\"    private long pullTimeDelayMillsWhenException = 1000;\"},{\"fromLine\":117,\"toLine\":117,\"content\":\"    private static final long PULL_TIME_DELAY_MILLS_WHEN_CACHE_FLOW_CONTROL = 50;\"},{\"fromLine\":121,\"toLine\":121,\"content\":\"    private static final long PULL_TIME_DELAY_MILLS_WHEN_BROKER_FLOW_CONTROL = 20;\"},{\"fromLine\":125,\"toLine\":125,\"content\":\"    private static final long PULL_TIME_DELAY_MILLS_WHEN_PAUSE = 1000;\"},{\"fromLine\":127,\"toLine\":127,\"content\":\"    private static final long PULL_TIME_DELAY_MILLS_ON_EXCEPTION = 3 * 1000;\"},{\"fromLine\":129,\"toLine\":129,\"content\":\"    private ConcurrentHashMap<String/* topic */, String/* subExpression */> topicToSubExpression = new ConcurrentHashMap<>();\"},{\"fromLine\":131,\"toLine\":131,\"content\":\"    private DefaultLitePullConsumer defaultLitePullConsumer;\"},{\"fromLine\":133,\"toLine\":133,\"content\":\"    private final ConcurrentMap<MessageQueue, PullTaskImpl> taskTable =\"},{\"fromLine\":136,\"toLine\":136,\"content\":\"    private AssignedMessageQueue assignedMessageQueue = new AssignedMessageQueue();\"},{\"fromLine\":138,\"toLine\":138,\"content\":\"    private final BlockingQueue<ConsumeRequest> consumeRequestCache = new LinkedBlockingQueue<>();\"},{\"fromLine\":140,\"toLine\":140,\"content\":\"    private ScheduledThreadPoolExecutor scheduledThreadPoolExecutor;\"},{\"fromLine\":142,\"toLine\":142,\"content\":\"    private final ScheduledExecutorService scheduledExecutorService;\"},{\"fromLine\":144,\"toLine\":144,\"content\":\"    private Map<String, TopicMessageQueueChangeListener> topicMessageQueueChangeListenerMap = new HashMap<>();\"},{\"fromLine\":146,\"toLine\":146,\"content\":\"    private Map<String, Set<MessageQueue>> messageQueuesForTopic = new HashMap<>();\"},{\"fromLine\":148,\"toLine\":148,\"content\":\"    private long consumeRequestFlowControlTimes = 0L;\"},{\"fromLine\":150,\"toLine\":150,\"content\":\"    private long queueFlowControlTimes = 0L;\"},{\"fromLine\":152,\"toLine\":152,\"content\":\"    private long queueMaxSpanFlowControlTimes = 0L;\"},{\"fromLine\":154,\"toLine\":154,\"content\":\"    private long nextAutoCommitDeadline = -1L;\"},{\"fromLine\":156,\"toLine\":156,\"content\":\"    private final MessageQueueLock messageQueueLock = new MessageQueueLock();\"},{\"fromLine\":158,\"toLine\":158,\"content\":\"    private final ArrayList<ConsumeMessageHook> consumeMessageHookList = new ArrayList<>();\"},{\"fromLine\":162,\"toLine\":162,\"content\":\"    private static boolean doNotUpdateTopicSubscribeInfoWhenSubscriptionChanged = false;\"},{\"fromLine\":247,\"toLine\":247,\"content\":\"    public void updateAssignQueueAndStartPullTask(String topic, Set<MessageQueue> mqAll, Set<MessageQueue> mqDivided) {\"},{\"fromLine\":489,\"toLine\":490,\"content\":\"    public synchronized void subscribe(String topic, String subExpression,\\n        MessageQueueListener messageQueueListener) throws MQClientException {\"},{\"fromLine\":797,\"toLine\":797,\"content\":\"    private void updatePullOffset(MessageQueue messageQueue, long nextPullOffset, ProcessQueue processQueue) {\"},{\"fromLine\":1021,\"toLine\":1021,\"content\":\"    private PullResult pull(MessageQueue mq, SubscriptionData subscriptionData, long offset, int maxNums)\"},{\"fromLine\":1026,\"toLine\":1026,\"content\":\"    private PullResult pull(MessageQueue mq, SubscriptionData subscriptionData, long offset, int maxNums, long timeout)\"},{\"fromLine\":1031,\"toLine\":1033,\"content\":\"    private PullResult pullSyncImpl(MessageQueue mq, SubscriptionData subscriptionData, long offset, int maxNums,\\n        boolean block,\\n        long timeout)\"},{\"fromLine\":1200,\"toLine\":1200,\"content\":\"    private void updateConsumeOffsetToBroker(MessageQueue mq, long offset, boolean isOneway) throws RemotingException,\"}],\"client/src/main/java/org/apache/rocketmq/client/impl/consumer/DefaultMQPushConsumerImpl.java\":[{\"fromLine\":16,\"toLine\":96,\"content\":\" */\\npackage org.apache.rocketmq.client.impl.consumer;\\n\\nimport java.util.ArrayList;\\nimport java.util.Date;\\nimport java.util.HashMap;\\nimport java.util.HashSet;\\nimport java.util.Iterator;\\nimport java.util.List;\\nimport java.util.Map;\\nimport java.util.Map.Entry;\\nimport java.util.Properties;\\nimport java.util.Set;\\nimport java.util.concurrent.ConcurrentMap;\\nimport org.apache.commons.collections.CollectionUtils;\\nimport org.apache.commons.lang3.StringUtils;\\nimport org.apache.rocketmq.client.QueryResult;\\nimport org.apache.rocketmq.client.Validators;\\nimport org.apache.rocketmq.client.consumer.AckCallback;\\nimport org.apache.rocketmq.client.consumer.AckResult;\\nimport org.apache.rocketmq.client.consumer.AckStatus;\\nimport org.apache.rocketmq.client.consumer.DefaultMQPushConsumer;\\nimport org.apache.rocketmq.client.consumer.MessageQueueListener;\\nimport org.apache.rocketmq.client.consumer.MessageSelector;\\nimport org.apache.rocketmq.client.consumer.PopCallback;\\nimport org.apache.rocketmq.client.consumer.PopResult;\\nimport org.apache.rocketmq.client.consumer.PopStatus;\\nimport org.apache.rocketmq.client.consumer.PullCallback;\\nimport org.apache.rocketmq.client.consumer.PullResult;\\nimport org.apache.rocketmq.client.consumer.listener.MessageListener;\\nimport org.apache.rocketmq.client.consumer.listener.MessageListenerConcurrently;\\nimport org.apache.rocketmq.client.consumer.listener.MessageListenerOrderly;\\nimport org.apache.rocketmq.client.consumer.store.LocalFileOffsetStore;\\nimport org.apache.rocketmq.client.consumer.store.OffsetStore;\\nimport org.apache.rocketmq.client.consumer.store.ReadOffsetType;\\nimport org.apache.rocketmq.client.consumer.store.RemoteBrokerOffsetStore;\\nimport org.apache.rocketmq.client.exception.MQBrokerException;\\nimport org.apache.rocketmq.client.exception.MQClientException;\\nimport org.apache.rocketmq.client.hook.ConsumeMessageContext;\\nimport org.apache.rocketmq.client.hook.ConsumeMessageHook;\\nimport org.apache.rocketmq.client.hook.FilterMessageContext;\\nimport org.apache.rocketmq.client.hook.FilterMessageHook;\\nimport org.apache.rocketmq.client.impl.CommunicationMode;\\nimport org.apache.rocketmq.client.impl.FindBrokerResult;\\nimport org.apache.rocketmq.client.impl.MQClientManager;\\nimport org.apache.rocketmq.client.impl.factory.MQClientInstance;\\nimport org.apache.rocketmq.client.stat.ConsumerStatsManager;\\nimport org.apache.rocketmq.common.KeyBuilder;\\nimport org.apache.rocketmq.common.MixAll;\\nimport org.apache.rocketmq.common.ServiceState;\\nimport org.apache.rocketmq.common.UtilAll;\\nimport org.apache.rocketmq.common.consumer.ConsumeFromWhere;\\nimport org.apache.rocketmq.common.help.FAQUrl;\\nimport org.apache.rocketmq.common.message.Message;\\nimport org.apache.rocketmq.common.message.MessageAccessor;\\nimport org.apache.rocketmq.common.message.MessageConst;\\nimport org.apache.rocketmq.common.message.MessageExt;\\nimport org.apache.rocketmq.common.message.MessageQueue;\\nimport org.apache.rocketmq.common.sysflag.PullSysFlag;\\nimport org.apache.rocketmq.remoting.RPCHook;\\nimport org.apache.rocketmq.remoting.common.RemotingHelper;\\nimport org.apache.rocketmq.remoting.exception.RemotingException;\\nimport org.apache.rocketmq.remoting.protocol.NamespaceUtil;\\nimport org.apache.rocketmq.remoting.protocol.ResponseCode;\\nimport org.apache.rocketmq.remoting.protocol.body.ConsumeStatus;\\nimport org.apache.rocketmq.remoting.protocol.body.ConsumerRunningInfo;\\nimport org.apache.rocketmq.remoting.protocol.body.PopProcessQueueInfo;\\nimport org.apache.rocketmq.remoting.protocol.body.ProcessQueueInfo;\\nimport org.apache.rocketmq.remoting.protocol.body.QueueTimeSpan;\\nimport org.apache.rocketmq.remoting.protocol.filter.FilterAPI;\\nimport org.apache.rocketmq.remoting.protocol.header.AckMessageRequestHeader;\\nimport org.apache.rocketmq.remoting.protocol.header.ChangeInvisibleTimeRequestHeader;\\nimport org.apache.rocketmq.remoting.protocol.header.ExtraInfoUtil;\\nimport org.apache.rocketmq.remoting.protocol.heartbeat.ConsumeType;\\nimport org.apache.rocketmq.remoting.protocol.heartbeat.MessageModel;\\nimport org.apache.rocketmq.remoting.protocol.heartbeat.SubscriptionData;\\nimport org.apache.rocketmq.remoting.protocol.route.BrokerData;\\nimport org.apache.rocketmq.remoting.protocol.route.TopicRouteData;\\nimport org.apache.rocketmq.logging.org.slf4j.Logger;\\nimport org.apache.rocketmq.logging.org.slf4j.LoggerFactory;\\n\"},{\"fromLine\":101,\"toLine\":101,\"content\":\"    private long pullTimeDelayMillsWhenException = 3000;\"},{\"fromLine\":105,\"toLine\":105,\"content\":\"    private static final long PULL_TIME_DELAY_MILLS_WHEN_CACHE_FLOW_CONTROL = 50;\"},{\"fromLine\":109,\"toLine\":109,\"content\":\"    private static final long PULL_TIME_DELAY_MILLS_WHEN_BROKER_FLOW_CONTROL = 20;\"},{\"fromLine\":113,\"toLine\":133,\"content\":\"    private static final long PULL_TIME_DELAY_MILLS_WHEN_SUSPEND = 1000;\\n    private static final long BROKER_SUSPEND_MAX_TIME_MILLIS = 1000 * 15;\\n    private static final long CONSUMER_TIMEOUT_MILLIS_WHEN_SUSPEND = 1000 * 30;\\n    private static final Logger log = LoggerFactory.getLogger(DefaultMQPushConsumerImpl.class);\\n    private final DefaultMQPushConsumer defaultMQPushConsumer;\\n    private final RebalanceImpl rebalanceImpl = new RebalancePushImpl(this);\\n    private final ArrayList<FilterMessageHook> filterMessageHookList = new ArrayList<>();\\n    private final long consumerStartTimestamp = System.currentTimeMillis();\\n    private final ArrayList<ConsumeMessageHook> consumeMessageHookList = new ArrayList<>();\\n    private final RPCHook rpcHook;\\n    private volatile ServiceState serviceState = ServiceState.CREATE_JUST;\\n    private MQClientInstance mQClientFactory;\\n    private PullAPIWrapper pullAPIWrapper;\\n    private volatile boolean pause = false;\\n    private boolean consumeOrderly = false;\\n    private MessageListener messageListenerInner;\\n    private OffsetStore offsetStore;\\n    private ConsumeMessageService consumeMessageService;\\n    private ConsumeMessageService consumeMessagePopService;\\n    private long queueFlowControlTimes = 0;\\n    private long queueMaxSpanFlowControlTimes = 0;\"},{\"fromLine\":136,\"toLine\":136,\"content\":\"    private final int[] popDelayLevel = new int[] {10, 30, 60, 120, 180, 240, 300, 360, 420, 480, 540, 600, 1200, 1800, 3600, 7200};\"},{\"fromLine\":138,\"toLine\":140,\"content\":\"    private static final int MAX_POP_INVISIBLE_TIME = 300000;\\n    private static final int MIN_POP_INVISIBLE_TIME = 5000;\\n    private static final int ASYNC_TIMEOUT = 3000;\"},{\"fromLine\":144,\"toLine\":144,\"content\":\"    private static boolean doNotUpdateTopicSubscribeInfoWhenSubscriptionChanged = false;\"},{\"fromLine\":190,\"toLine\":190,\"content\":\"    public void createTopic(String key, String newTopic, int queueNum) throws MQClientException {\"},{\"fromLine\":194,\"toLine\":194,\"content\":\"    public void createTopic(String key, String newTopic, int queueNum, int topicSysFlag) throws MQClientException {\"},{\"fromLine\":719,\"toLine\":719,\"content\":\"    public QueryResult queryMessage(String topic, String key, int maxNum, long begin, long end)\"},{\"fromLine\":740,\"toLine\":740,\"content\":\"    public void sendMessageBack(MessageExt msg, int delayLevel, final String brokerName)\"},{\"fromLine\":745,\"toLine\":745,\"content\":\"    public void sendMessageBack(MessageExt msg, int delayLevel, final MessageQueue mq)\"},{\"fromLine\":751,\"toLine\":751,\"content\":\"    private void sendMessageBack(MessageExt msg, int delayLevel, final String brokerName, final MessageQueue mq)\"},{\"fromLine\":846,\"toLine\":846,\"content\":\"    void changePopInvisibleTimeAsync(String topic, String consumerGroup, String extraInfo, long invisibleTime, AckCallback callback)\"},{\"fromLine\":1260,\"toLine\":1260,\"content\":\"    public void subscribe(String topic, String fullClassName, String filterClassSource) throws MQClientException {\"}],\"common/src/main/java/org/apache/rocketmq/common/BrokerConfig.java\":[{\"fromLine\":16,\"toLine\":27,\"content\":\" */\\npackage org.apache.rocketmq.common;\\n\\nimport org.apache.rocketmq.common.annotation.ImportantField;\\nimport org.apache.rocketmq.common.constant.PermName;\\nimport org.apache.rocketmq.common.message.MessageRequestMode;\\nimport org.apache.rocketmq.common.metrics.MetricsExporterType;\\nimport org.apache.rocketmq.common.topic.TopicValidator;\\nimport org.apache.rocketmq.common.utils.NetworkUtil;\\n\\nimport java.util.concurrent.TimeUnit;\\n\"},{\"fromLine\":30,\"toLine\":30,\"content\":\"    private String brokerConfigPath = null;\"},{\"fromLine\":32,\"toLine\":32,\"content\":\"    private String rocketmqHome = System.getProperty(MixAll.ROCKETMQ_HOME_PROPERTY, System.getenv(MixAll.ROCKETMQ_HOME_ENV));\"},{\"fromLine\":34,\"toLine\":34,\"content\":\"    private String namesrvAddr = System.getProperty(MixAll.NAMESRV_ADDR_PROPERTY, System.getenv(MixAll.NAMESRV_ADDR_ENV));\"},{\"fromLine\":40,\"toLine\":40,\"content\":\"    private int listenPort = 6888;\"},{\"fromLine\":43,\"toLine\":44,\"content\":\"    private String brokerIP1 = NetworkUtil.getLocalAddress();\\n    private String brokerIP2 = NetworkUtil.getLocalAddress();\"},{\"fromLine\":47,\"toLine\":47,\"content\":\"    private boolean recoverConcurrently = false;\"},{\"fromLine\":49,\"toLine\":50,\"content\":\"    private int brokerPermission = PermName.PERM_READ | PermName.PERM_WRITE;\\n    private int defaultTopicQueueNums = 8;\"},{\"fromLine\":52,\"toLine\":52,\"content\":\"    private boolean autoCreateTopicEnable = true;\"},{\"fromLine\":54,\"toLine\":54,\"content\":\"    private boolean clusterTopicEnable = true;\"},{\"fromLine\":56,\"toLine\":56,\"content\":\"    private boolean brokerTopicEnable = true;\"},{\"fromLine\":58,\"toLine\":59,\"content\":\"    private boolean autoCreateSubscriptionGroup = true;\\n    private String messageStorePlugIn = \\\"\\\";\"},{\"fromLine\":61,\"toLine\":61,\"content\":\"    private static final int PROCESSOR_NUMBER = Runtime.getRuntime().availableProcessors();\"},{\"fromLine\":63,\"toLine\":63,\"content\":\"    private String msgTraceTopicName = TopicValidator.RMQ_SYS_TRACE_TOPIC;\"},{\"fromLine\":65,\"toLine\":65,\"content\":\"    private boolean traceTopicEnable = false;\"},{\"fromLine\":69,\"toLine\":75,\"content\":\"    private int sendMessageThreadPoolNums = Math.min(PROCESSOR_NUMBER, 4);\\n    private int putMessageFutureThreadPoolNums = Math.min(PROCESSOR_NUMBER, 4);\\n    private int pullMessageThreadPoolNums = 16 + PROCESSOR_NUMBER * 2;\\n    private int litePullMessageThreadPoolNums = 16 + PROCESSOR_NUMBER * 2;\\n    private int ackMessageThreadPoolNums = 3;\\n    private int processReplyMessageThreadPoolNums = 16 + PROCESSOR_NUMBER * 2;\\n    private int queryMessageThreadPoolNums = 8 + PROCESSOR_NUMBER;\"},{\"fromLine\":77,\"toLine\":82,\"content\":\"    private int adminBrokerThreadPoolNums = 16;\\n    private int clientManageThreadPoolNums = 32;\\n    private int consumerManageThreadPoolNums = 32;\\n    private int loadBalanceProcessorThreadPoolNums = 32;\\n    private int heartbeatThreadPoolNums = Math.min(32, PROCESSOR_NUMBER);\\n    private int recoverThreadPoolNums = 32;\"},{\"fromLine\":87,\"toLine\":87,\"content\":\"    private int endTransactionThreadPoolNums = Math.max(8 + PROCESSOR_NUMBER * 2,\"},{\"fromLine\":90,\"toLine\":90,\"content\":\"    private int flushConsumerOffsetInterval = 1000 * 5;\"},{\"fromLine\":92,\"toLine\":92,\"content\":\"    private int flushConsumerOffsetHistoryInterval = 1000 * 60;\"},{\"fromLine\":95,\"toLine\":95,\"content\":\"    private boolean rejectTransactionMessage = false;\"},{\"fromLine\":98,\"toLine\":98,\"content\":\"    private boolean fetchNameSrvAddrByDnsLookup = false;\"},{\"fromLine\":101,\"toLine\":101,\"content\":\"    private boolean fetchNamesrvAddrByAddressServer = false;\"},{\"fromLine\":103,\"toLine\":115,\"content\":\"    private int sendThreadPoolQueueCapacity = 10000;\\n    private int putThreadPoolQueueCapacity = 10000;\\n    private int pullThreadPoolQueueCapacity = 100000;\\n    private int litePullThreadPoolQueueCapacity = 100000;\\n    private int ackThreadPoolQueueCapacity = 100000;\\n    private int replyThreadPoolQueueCapacity = 10000;\\n    private int queryThreadPoolQueueCapacity = 20000;\\n    private int clientManagerThreadPoolQueueCapacity = 1000000;\\n    private int consumerManagerThreadPoolQueueCapacity = 1000000;\\n    private int heartbeatThreadPoolQueueCapacity = 50000;\\n    private int endTransactionPoolQueueCapacity = 100000;\\n    private int adminBrokerThreadPoolQueueCapacity = 10000;\\n    private int loadBalanceThreadPoolQueueCapacity = 100000;\"},{\"fromLine\":117,\"toLine\":117,\"content\":\"    private boolean longPollingEnable = true;\"},{\"fromLine\":119,\"toLine\":119,\"content\":\"    private long shortPollingTimeMills = 1000;\"},{\"fromLine\":121,\"toLine\":121,\"content\":\"    private boolean notifyConsumerIdsChangedEnable = true;\"},{\"fromLine\":123,\"toLine\":123,\"content\":\"    private boolean highSpeedMode = false;\"},{\"fromLine\":125,\"toLine\":125,\"content\":\"    private int commercialBaseCount = 1;\"},{\"fromLine\":127,\"toLine\":127,\"content\":\"    private int commercialSizePerMsg = 4 * 1024;\"},{\"fromLine\":129,\"toLine\":130,\"content\":\"    private boolean accountStatsEnable = true;\\n    private boolean accountStatsPrintZeroValues = true;\"},{\"fromLine\":132,\"toLine\":132,\"content\":\"    private boolean transferMsgByHeap = true;\"},{\"fromLine\":134,\"toLine\":135,\"content\":\"    private String regionId = MixAll.DEFAULT_TRACE_REGION_ID;\\n    private int registerBrokerTimeoutMills = 24000;\"},{\"fromLine\":137,\"toLine\":137,\"content\":\"    private int sendHeartbeatTimeoutMillis = 1000;\"},{\"fromLine\":139,\"toLine\":139,\"content\":\"    private boolean slaveReadEnable = false;\"},{\"fromLine\":141,\"toLine\":142,\"content\":\"    private boolean disableConsumeIfConsumerReadSlowly = false;\\n    private long consumerFallbehindThreshold = 1024L * 1024 * 1024 * 16;\"},{\"fromLine\":144,\"toLine\":150,\"content\":\"    private boolean brokerFastFailureEnable = true;\\n    private long waitTimeMillsInSendQueue = 200;\\n    private long waitTimeMillsInPullQueue = 5 * 1000;\\n    private long waitTimeMillsInLitePullQueue = 5 * 1000;\\n    private long waitTimeMillsInHeartbeatQueue = 31 * 1000;\\n    private long waitTimeMillsInTransactionQueue = 3 * 1000;\\n    private long waitTimeMillsInAckQueue = 3000;\"},{\"fromLine\":152,\"toLine\":152,\"content\":\"    private long startAcceptSendRequestTimeStamp = 0L;\"},{\"fromLine\":154,\"toLine\":154,\"content\":\"    private boolean traceOn = true;\"},{\"fromLine\":160,\"toLine\":160,\"content\":\"    private boolean enableCalcFilterBitMap = false;\"},{\"fromLine\":163,\"toLine\":163,\"content\":\"    private boolean rejectPullConsumerEnable = false;\"},{\"fromLine\":166,\"toLine\":166,\"content\":\"    private int expectConsumerNumUseFilter = 32;\"},{\"fromLine\":169,\"toLine\":169,\"content\":\"    private int maxErrorRateOfBloomFilter = 20;\"},{\"fromLine\":172,\"toLine\":172,\"content\":\"    private long filterDataCleanTimeSpan = 24 * 3600 * 1000;\"},{\"fromLine\":175,\"toLine\":176,\"content\":\"    private boolean filterSupportRetry = false;\\n    private boolean enablePropertyFilter = false;\"},{\"fromLine\":178,\"toLine\":178,\"content\":\"    private boolean compressedRegister = false;\"},{\"fromLine\":180,\"toLine\":180,\"content\":\"    private boolean forceRegister = true;\"},{\"fromLine\":186,\"toLine\":186,\"content\":\"    private int registerNameServerPeriod = 1000 * 30;\"},{\"fromLine\":191,\"toLine\":191,\"content\":\"    private int brokerHeartbeatInterval = 1000;\"},{\"fromLine\":197,\"toLine\":197,\"content\":\"    private long brokerNotActiveTimeoutMillis = 10 * 1000;\"},{\"fromLine\":199,\"toLine\":199,\"content\":\"    private boolean enableNetWorkFlowControl = false;\"},{\"fromLine\":201,\"toLine\":201,\"content\":\"    private boolean enableBroadcastOffsetStore = true;\"},{\"fromLine\":203,\"toLine\":203,\"content\":\"    private long broadcastOffsetExpireSecond = 2 * 60;\"},{\"fromLine\":205,\"toLine\":205,\"content\":\"    private long broadcastOffsetExpireMaxSecond = 5 * 60;\"},{\"fromLine\":207,\"toLine\":208,\"content\":\"    private int popPollingSize = 1024;\\n    private int popPollingMapSize = 100000;\"},{\"fromLine\":210,\"toLine\":225,\"content\":\"    private long maxPopPollingSize = 100000;\\n    private int reviveQueueNum = 8;\\n    private long reviveInterval = 1000;\\n    private long reviveMaxSlow = 3;\\n    private long reviveScanTime = 10000;\\n    private boolean enableSkipLongAwaitingAck = false;\\n    private long reviveAckWaitMs = TimeUnit.MINUTES.toMillis(3);\\n    private boolean enablePopLog = false;\\n    private boolean enablePopBufferMerge = false;\\n    private int popCkStayBufferTime = 10 * 1000;\\n    private int popCkStayBufferTimeOut = 3 * 1000;\\n    private int popCkMaxBufferSize = 200000;\\n    private int popCkOffsetMaxQueueSize = 20000;\\n    private boolean enablePopBatchAck = false;\\n    private boolean enableNotifyAfterPopOrderLockRelease = true;\\n    private boolean initPopOffsetByCheckMsgInMem = true;\"},{\"fromLine\":227,\"toLine\":228,\"content\":\"    private boolean retrieveMessageFromPopRetryTopicV1 = true;\\n    private boolean enableRetryTopicV2 = false;\"},{\"fromLine\":230,\"toLine\":230,\"content\":\"    private boolean realTimeNotifyConsumerChange = true;\"},{\"fromLine\":232,\"toLine\":232,\"content\":\"    private boolean litePullMessageEnable = true;\"},{\"fromLine\":235,\"toLine\":235,\"content\":\"    private int syncBrokerMemberGroupPeriod = 1000;\"},{\"fromLine\":240,\"toLine\":240,\"content\":\"    private long loadBalancePollNameServerInterval = 1000 * 30;\"},{\"fromLine\":245,\"toLine\":245,\"content\":\"    private int cleanOfflineBrokerInterval = 1000 * 30;\"},{\"fromLine\":247,\"toLine\":247,\"content\":\"    private boolean serverLoadBalancerEnable = true;\"},{\"fromLine\":249,\"toLine\":249,\"content\":\"    private MessageRequestMode defaultMessageRequestMode = MessageRequestMode.PULL;\"},{\"fromLine\":251,\"toLine\":251,\"content\":\"    private int defaultPopShareQueueNum = -1;\"},{\"fromLine\":258,\"toLine\":258,\"content\":\"    private long transactionTimeOut = 6 * 1000;\"},{\"fromLine\":264,\"toLine\":264,\"content\":\"    private int transactionCheckMax = 15;\"},{\"fromLine\":270,\"toLine\":270,\"content\":\"    private long transactionCheckInterval = 30 * 1000;\"},{\"fromLine\":272,\"toLine\":272,\"content\":\"    private long transactionMetricFlushInterval = 3 * 1000;\"},{\"fromLine\":277,\"toLine\":277,\"content\":\"    private int transactionOpMsgMaxSize = 4096;\"},{\"fromLine\":279,\"toLine\":279,\"content\":\"    private int transactionOpBatchInterval = 3000;\"},{\"fromLine\":285,\"toLine\":285,\"content\":\"    private boolean aclEnable = false;\"},{\"fromLine\":287,\"toLine\":287,\"content\":\"    private boolean storeReplyMessageEnable = true;\"},{\"fromLine\":289,\"toLine\":289,\"content\":\"    private boolean enableDetailStat = true;\"},{\"fromLine\":291,\"toLine\":291,\"content\":\"    private boolean autoDeleteUnusedStats = false;\"},{\"fromLine\":296,\"toLine\":296,\"content\":\"    private boolean isolateLogEnable = false;\"},{\"fromLine\":298,\"toLine\":298,\"content\":\"    private long forwardTimeout = 3 * 1000;\"},{\"fromLine\":305,\"toLine\":305,\"content\":\"    private boolean enableSlaveActingMaster = false;\"},{\"fromLine\":307,\"toLine\":307,\"content\":\"    private boolean enableRemoteEscape = false;\"},{\"fromLine\":309,\"toLine\":309,\"content\":\"    private boolean skipPreOnline = false;\"},{\"fromLine\":311,\"toLine\":311,\"content\":\"    private boolean asyncSendEnable = true;\"},{\"fromLine\":313,\"toLine\":313,\"content\":\"    private boolean useServerSideResetOffset = true;\"},{\"fromLine\":315,\"toLine\":315,\"content\":\"    private long consumerOffsetUpdateVersionStep = 500;\"},{\"fromLine\":317,\"toLine\":317,\"content\":\"    private long delayOffsetUpdateVersionStep = 200;\"},{\"fromLine\":324,\"toLine\":324,\"content\":\"    private boolean lockInStrictMode = false;\"},{\"fromLine\":326,\"toLine\":326,\"content\":\"    private boolean compatibleWithOldNameSrv = true;\"},{\"fromLine\":331,\"toLine\":331,\"content\":\"    private boolean enableControllerMode = false;\"},{\"fromLine\":333,\"toLine\":333,\"content\":\"    private String controllerAddr = \\\"\\\";\"},{\"fromLine\":335,\"toLine\":335,\"content\":\"    private boolean fetchControllerAddrByDnsLookup = false;\"},{\"fromLine\":337,\"toLine\":337,\"content\":\"    private long syncBrokerMetadataPeriod = 5 * 1000;\"},{\"fromLine\":339,\"toLine\":339,\"content\":\"    private long checkSyncStateSetPeriod = 5 * 1000;\"},{\"fromLine\":341,\"toLine\":341,\"content\":\"    private long syncControllerMetadataPeriod = 10 * 1000;\"},{\"fromLine\":343,\"toLine\":343,\"content\":\"    private long controllerHeartBeatTimeoutMills = 10 * 1000;\"},{\"fromLine\":345,\"toLine\":345,\"content\":\"    private boolean validateSystemTopicWhenUpdateTopic = true;\"},{\"fromLine\":352,\"toLine\":352,\"content\":\"    private int brokerElectionPriority = Integer.MAX_VALUE;\"},{\"fromLine\":354,\"toLine\":354,\"content\":\"    private boolean useStaticSubscription = false;\"},{\"fromLine\":356,\"toLine\":356,\"content\":\"    private MetricsExporterType metricsExporterType = MetricsExporterType.DISABLE;\"},{\"fromLine\":358,\"toLine\":363,\"content\":\"    private int metricsOtelCardinalityLimit = 50 * 1000;\\n    private String metricsGrpcExporterTarget = \\\"\\\";\\n    private String metricsGrpcExporterHeader = \\\"\\\";\\n    private long metricGrpcExporterTimeOutInMills = 3 * 1000;\\n    private long metricGrpcExporterIntervalInMills = 60 * 1000;\\n    private long metricLoggingExporterIntervalInMills = 10 * 1000;\"},{\"fromLine\":365,\"toLine\":366,\"content\":\"    private int metricsPromExporterPort = 5557;\\n    private String metricsPromExporterHost = \\\"\\\";\"},{\"fromLine\":369,\"toLine\":369,\"content\":\"    private String metricsLabel = \\\"\\\";\"},{\"fromLine\":371,\"toLine\":371,\"content\":\"    private boolean metricsInDelta = false;\"},{\"fromLine\":373,\"toLine\":374,\"content\":\"    private long channelExpiredTimeout = 1000 * 120;\\n    private long subscriptionExpiredTimeout = 1000 * 60 * 10;\"},{\"fromLine\":379,\"toLine\":379,\"content\":\"    private boolean estimateAccumulation = true;\"},{\"fromLine\":381,\"toLine\":384,\"content\":\"    private boolean coldCtrStrategyEnable = false;\\n    private boolean usePIDColdCtrStrategy = true;\\n    private long cgColdReadThreshold = 3 * 1024 * 1024;\\n    private long globalColdReadThreshold = 100 * 1024 * 1024;\"},{\"fromLine\":389,\"toLine\":389,\"content\":\"    private long fetchNamesrvAddrInterval = 10 * 1000;\"},{\"fromLine\":394,\"toLine\":394,\"content\":\"    private boolean popResponseReturnActualRetryTopic = false;\"},{\"fromLine\":400,\"toLine\":400,\"content\":\"    private boolean enableSingleTopicRegister = false;\"},{\"fromLine\":402,\"toLine\":402,\"content\":\"    private boolean enableMixedMessageType = false;\"},{\"fromLine\":408,\"toLine\":408,\"content\":\"    private boolean enableSplitRegistration = false;\"},{\"fromLine\":410,\"toLine\":411,\"content\":\"    private long popInflightMessageThreshold = 10000;\\n    private boolean enablePopMessageThreshold = false;\"},{\"fromLine\":413,\"toLine\":413,\"content\":\"    private int splitRegistrationSize = 800;\"},{\"fromLine\":420,\"toLine\":420,\"content\":\"    private String configBlackList = \\\"configBlackList;brokerConfigPath\\\";\"}],\"proxy/src/main/java/org/apache/rocketmq/proxy/config/ProxyConfig.java\":[{\"fromLine\":17,\"toLine\":40,\"content\":\"\\npackage org.apache.rocketmq.proxy.config;\\n\\nimport java.net.InetAddress;\\nimport java.net.UnknownHostException;\\nimport java.time.Duration;\\nimport java.util.Comparator;\\nimport java.util.HashMap;\\nimport java.util.List;\\nimport java.util.Map;\\nimport java.util.concurrent.ConcurrentSkipListMap;\\nimport java.util.concurrent.TimeUnit;\\nimport java.util.stream.Collectors;\\nimport org.apache.commons.lang3.StringUtils;\\nimport org.apache.rocketmq.common.MixAll;\\nimport org.apache.rocketmq.common.constant.LoggerName;\\nimport org.apache.rocketmq.common.metrics.MetricsExporterType;\\nimport org.apache.rocketmq.common.utils.NetworkUtil;\\nimport org.apache.rocketmq.logging.org.slf4j.Logger;\\nimport org.apache.rocketmq.logging.org.slf4j.LoggerFactory;\\nimport org.apache.rocketmq.proxy.ProxyMode;\\nimport org.apache.rocketmq.proxy.common.ProxyException;\\nimport org.apache.rocketmq.proxy.common.ProxyExceptionCode;\\n\"},{\"fromLine\":42,\"toLine\":45,\"content\":\"    private final static Logger log = LoggerFactory.getLogger(LoggerName.PROXY_LOGGER_NAME);\\n    public final static String DEFAULT_CONFIG_FILE_NAME = \\\"rmq-proxy.json\\\";\\n    private static final int PROCESSOR_NUMBER = Runtime.getRuntime().availableProcessors();\\n    private static final String DEFAULT_CLUSTER_NAME = \\\"DefaultCluster\\\";\"},{\"fromLine\":47,\"toLine\":47,\"content\":\"    private static String localHostName;\"},{\"fromLine\":57,\"toLine\":59,\"content\":\"    private String rocketMQClusterName = DEFAULT_CLUSTER_NAME;\\n    private String proxyClusterName = DEFAULT_CLUSTER_NAME;\\n    private String proxyName = StringUtils.isEmpty(localHostName) ? \\\"DEFAULT_PROXY\\\" : localHostName;\"},{\"fromLine\":61,\"toLine\":61,\"content\":\"    private String localServeAddr = \\\"\\\";\"},{\"fromLine\":63,\"toLine\":65,\"content\":\"    private String heartbeatSyncerTopicClusterName = \\\"\\\";\\n    private int heartbeatSyncerThreadPoolNums = 4;\\n    private int heartbeatSyncerThreadPoolQueueCapacity = 100;\"},{\"fromLine\":67,\"toLine\":67,\"content\":\"    private String heartbeatSyncerTopicName = \\\"DefaultHeartBeatSyncerTopic\\\";\"},{\"fromLine\":72,\"toLine\":74,\"content\":\"    private boolean enablePrintJstack = true;\\n    private long printJstackInMillis = Duration.ofSeconds(60).toMillis();\\n    private long printThreadPoolStatusInMillis = Duration.ofSeconds(3).toMillis();\"},{\"fromLine\":76,\"toLine\":78,\"content\":\"    private String namesrvAddr = System.getProperty(MixAll.NAMESRV_ADDR_PROPERTY, System.getenv(MixAll.NAMESRV_ADDR_ENV));\\n    private String namesrvDomain = \\\"\\\";\\n    private String namesrvDomainSubgroup = \\\"\\\";\"},{\"fromLine\":82,\"toLine\":84,\"content\":\"    private boolean tlsTestModeEnable = true;\\n    private String tlsKeyPath = ConfigurationManager.getProxyHome() + \\\"/conf/tls/rocketmq.key\\\";\\n    private String tlsCertPath = ConfigurationManager.getProxyHome() + \\\"/conf/tls/rocketmq.crt\\\";\"},{\"fromLine\":88,\"toLine\":96,\"content\":\"    private String proxyMode = ProxyMode.CLUSTER.name();\\n    private Integer grpcServerPort = 8081;\\n    private long grpcShutdownTimeSeconds = 30;\\n    private int grpcBossLoopNum = 1;\\n    private int grpcWorkerLoopNum = PROCESSOR_NUMBER * 2;\\n    private boolean enableGrpcEpoll = false;\\n    private int grpcThreadPoolNums = 16 + PROCESSOR_NUMBER * 2;\\n    private int grpcThreadPoolQueueCapacity = 100000;\\n    private String brokerConfigPath = ConfigurationManager.getProxyHome() + \\\"/conf/broker.conf\\\";\"},{\"fromLine\":101,\"toLine\":101,\"content\":\"    private int grpcMaxInboundMessageSize = 130 * 1024 * 1024;\"},{\"fromLine\":105,\"toLine\":105,\"content\":\"    private int maxMessageSize = 4 * 1024 * 1024;\"},{\"fromLine\":109,\"toLine\":110,\"content\":\"    private int maxUserPropertySize = 16 * 1024;\\n    private int userPropertyMaxNum = 128;\"},{\"fromLine\":115,\"toLine\":115,\"content\":\"    private int maxMessageGroupSize = 64;\"},{\"fromLine\":120,\"toLine\":125,\"content\":\"    private long defaultInvisibleTimeMills = Duration.ofSeconds(60).toMillis();\\n    private long minInvisibleTimeMillsForRecv = Duration.ofSeconds(10).toMillis();\\n    private long maxInvisibleTimeMills = Duration.ofHours(12).toMillis();\\n    private long maxDelayTimeMills = Duration.ofDays(1).toMillis();\\n    private long maxTransactionRecoverySecond = Duration.ofHours(1).getSeconds();\\n    private boolean enableTopicMessageTypeCheck = true;\"},{\"fromLine\":127,\"toLine\":134,\"content\":\"    private int grpcClientProducerMaxAttempts = 3;\\n    private long grpcClientProducerBackoffInitialMillis = 10;\\n    private long grpcClientProducerBackoffMaxMillis = 1000;\\n    private int grpcClientProducerBackoffMultiplier = 2;\\n    private long grpcClientConsumerMinLongPollingTimeoutMillis = Duration.ofSeconds(5).toMillis();\\n    private long grpcClientConsumerMaxLongPollingTimeoutMillis = Duration.ofSeconds(20).toMillis();\\n    private int grpcClientConsumerLongPollingBatchSize = 32;\\n    private long grpcClientIdleTimeMills = Duration.ofSeconds(120).toMillis();\"},{\"fromLine\":136,\"toLine\":137,\"content\":\"    private int channelExpiredInSeconds = 60;\\n    private int contextExpiredInSeconds = 30;\"},{\"fromLine\":139,\"toLine\":139,\"content\":\"    private int rocketmqMQClientNum = 6;\"},{\"fromLine\":141,\"toLine\":151,\"content\":\"    private long grpcProxyRelayRequestTimeoutInSeconds = 5;\\n    private int grpcProducerThreadPoolNums = PROCESSOR_NUMBER;\\n    private int grpcProducerThreadQueueCapacity = 10000;\\n    private int grpcConsumerThreadPoolNums = PROCESSOR_NUMBER;\\n    private int grpcConsumerThreadQueueCapacity = 10000;\\n    private int grpcRouteThreadPoolNums = PROCESSOR_NUMBER;\\n    private int grpcRouteThreadQueueCapacity = 10000;\\n    private int grpcClientManagerThreadPoolNums = PROCESSOR_NUMBER;\\n    private int grpcClientManagerThreadQueueCapacity = 10000;\\n    private int grpcTransactionThreadPoolNums = PROCESSOR_NUMBER;\\n    private int grpcTransactionThreadQueueCapacity = 10000;\"},{\"fromLine\":153,\"toLine\":156,\"content\":\"    private int producerProcessorThreadPoolNums = PROCESSOR_NUMBER;\\n    private int producerProcessorThreadPoolQueueCapacity = 10000;\\n    private int consumerProcessorThreadPoolNums = PROCESSOR_NUMBER;\\n    private int consumerProcessorThreadPoolQueueCapacity = 10000;\"},{\"fromLine\":158,\"toLine\":158,\"content\":\"    private boolean useEndpointPortFromRequest = false;\"},{\"fromLine\":160,\"toLine\":178,\"content\":\"    private int topicRouteServiceCacheExpiredSeconds = 300;\\n    private int topicRouteServiceCacheRefreshSeconds = 20;\\n    private int topicRouteServiceCacheMaxNum = 20000;\\n    private int topicRouteServiceThreadPoolNums = PROCESSOR_NUMBER;\\n    private int topicRouteServiceThreadPoolQueueCapacity = 5000;\\n    private int topicConfigCacheExpiredSeconds = 300;\\n    private int topicConfigCacheRefreshSeconds = 20;\\n    private int topicConfigCacheMaxNum = 20000;\\n    private int subscriptionGroupConfigCacheExpiredSeconds = 300;\\n    private int subscriptionGroupConfigCacheRefreshSeconds = 20;\\n    private int subscriptionGroupConfigCacheMaxNum = 20000;\\n    private int userCacheExpiredSeconds = 300;\\n    private int userCacheRefreshSeconds = 20;\\n    private int userCacheMaxNum = 20000;\\n    private int aclCacheExpiredSeconds = 300;\\n    private int aclCacheRefreshSeconds = 20;\\n    private int aclCacheMaxNum = 20000;\\n    private int metadataThreadPoolNums = 3;\\n    private int metadataThreadPoolQueueCapacity = 100000;\"},{\"fromLine\":180,\"toLine\":187,\"content\":\"    private int transactionHeartbeatThreadPoolNums = 20;\\n    private int transactionHeartbeatThreadPoolQueueCapacity = 200;\\n    private int transactionHeartbeatPeriodSecond = 20;\\n    private int transactionHeartbeatBatchNum = 100;\\n    private long transactionDataExpireScanPeriodMillis = Duration.ofSeconds(10).toMillis();\\n    private long transactionDataMaxWaitClearMillis = Duration.ofSeconds(30).toMillis();\\n    private long transactionDataExpireMillis = Duration.ofSeconds(30).toMillis();\\n    private int transactionDataMaxNum = 15;\"},{\"fromLine\":189,\"toLine\":189,\"content\":\"    private long longPollingReserveTimeInMillis = 100;\"},{\"fromLine\":191,\"toLine\":200,\"content\":\"    private long invisibleTimeMillisWhenClear = 1000L;\\n    private boolean enableProxyAutoRenew = true;\\n    private int maxRenewRetryTimes = 3;\\n    private int renewThreadPoolNums = 2;\\n    private int renewMaxThreadPoolNums = 4;\\n    private int renewThreadPoolQueueCapacity = 300;\\n    private long lockTimeoutMsInHandleGroup = TimeUnit.SECONDS.toMillis(3);\\n    private long renewAheadTimeMillis = TimeUnit.SECONDS.toMillis(10);\\n    private long renewMaxTimeMillis = TimeUnit.HOURS.toMillis(3);\\n    private long renewSchedulePeriodMillis = TimeUnit.SECONDS.toMillis(5);\"},{\"fromLine\":202,\"toLine\":202,\"content\":\"    private boolean enableACL = false;\"},{\"fromLine\":204,\"toLine\":204,\"content\":\"    private boolean enableAclRpcHookForClusterMode = false;\"},{\"fromLine\":206,\"toLine\":208,\"content\":\"    private boolean useDelayLevel = false;\\n    private String messageDelayLevel = \\\"1s 5s 10s 30s 1m 2m 3m 4m 5m 6m 7m 8m 9m 10m 20m 30m 1h 2h\\\";\\n    private transient ConcurrentSkipListMap<Integer /* level */, Long/* delay timeMillis */> delayLevelTable = new ConcurrentSkipListMap<>();\"},{\"fromLine\":210,\"toLine\":210,\"content\":\"    private String metricCollectorMode = MetricCollectorMode.OFF.getModeString();\"},{\"fromLine\":212,\"toLine\":212,\"content\":\"    private String metricCollectorAddress = \\\"\\\";\"},{\"fromLine\":214,\"toLine\":214,\"content\":\"    private String regionId = \\\"\\\";\"},{\"fromLine\":216,\"toLine\":216,\"content\":\"    private boolean traceOn = false;\"},{\"fromLine\":218,\"toLine\":218,\"content\":\"    private MetricsExporterType metricsExporterType = MetricsExporterType.DISABLE;\"},{\"fromLine\":220,\"toLine\":224,\"content\":\"    private String metricsGrpcExporterTarget = \\\"\\\";\\n    private String metricsGrpcExporterHeader = \\\"\\\";\\n    private long metricGrpcExporterTimeOutInMills = 3 * 1000;\\n    private long metricGrpcExporterIntervalInMills = 60 * 1000;\\n    private long metricLoggingExporterIntervalInMills = 10 * 1000;\"},{\"fromLine\":226,\"toLine\":227,\"content\":\"    private int metricsPromExporterPort = 5557;\\n    private String metricsPromExporterHost = \\\"\\\";\"},{\"fromLine\":230,\"toLine\":230,\"content\":\"    private String metricsLabel = \\\"\\\";\"},{\"fromLine\":232,\"toLine\":232,\"content\":\"    private boolean metricsInDelta = false;\"},{\"fromLine\":234,\"toLine\":234,\"content\":\"    private long channelExpiredTimeout = 1000 * 120;\"},{\"fromLine\":237,\"toLine\":240,\"content\":\"    private boolean enableRemotingLocalProxyGrpc = true;\\n    private int localProxyConnectTimeoutMs = 3000;\\n    private String remotingAccessAddr = \\\"\\\";\\n    private int remotingListenPort = 8080;\"},{\"fromLine\":243,\"toLine\":246,\"content\":\"    private boolean sendLatencyEnable = false;\\n    private boolean startDetectorEnable = false;\\n    private int detectTimeout = 200;\\n    private int detectInterval = 2 * 1000;\"},{\"fromLine\":248,\"toLine\":253,\"content\":\"    private int remotingHeartbeatThreadPoolNums = 2 * PROCESSOR_NUMBER;\\n    private int remotingTopicRouteThreadPoolNums = 2 * PROCESSOR_NUMBER;\\n    private int remotingSendMessageThreadPoolNums = 4 * PROCESSOR_NUMBER;\\n    private int remotingPullMessageThreadPoolNums = 4 * PROCESSOR_NUMBER;\\n    private int remotingUpdateOffsetThreadPoolNums = 4 * PROCESSOR_NUMBER;\\n    private int remotingDefaultThreadPoolNums = 4 * PROCESSOR_NUMBER;\"},{\"fromLine\":255,\"toLine\":260,\"content\":\"    private int remotingHeartbeatThreadPoolQueueCapacity = 50000;\\n    private int remotingTopicRouteThreadPoolQueueCapacity = 50000;\\n    private int remotingSendThreadPoolQueueCapacity = 10000;\\n    private int remotingPullThreadPoolQueueCapacity = 50000;\\n    private int remotingUpdateOffsetThreadPoolQueueCapacity = 10000;\\n    private int remotingDefaultThreadPoolQueueCapacity = 50000;\"},{\"fromLine\":262,\"toLine\":267,\"content\":\"    private long remotingWaitTimeMillsInSendQueue = 3 * 1000;\\n    private long remotingWaitTimeMillsInPullQueue = 5 * 1000;\\n    private long remotingWaitTimeMillsInHeartbeatQueue = 31 * 1000;\\n    private long remotingWaitTimeMillsInUpdateOffsetQueue = 3 * 1000;\\n    private long remotingWaitTimeMillsInTopicRouteQueue = 3 * 1000;\\n    private long remotingWaitTimeMillsInDefaultQueue = 3 * 1000;\"},{\"fromLine\":269,\"toLine\":269,\"content\":\"    private boolean enableBatchAck = false;\"}],\"broker/src/main/java/org/apache/rocketmq/broker/metrics/ConsumerLagCalculator.java\":[{\"fromLine\":16,\"toLine\":51,\"content\":\" */\\npackage org.apache.rocketmq.broker.metrics;\\n\\nimport java.util.Map;\\nimport java.util.Set;\\nimport java.util.function.Consumer;\\nimport java.util.stream.Collectors;\\nimport org.apache.rocketmq.broker.BrokerController;\\nimport org.apache.rocketmq.broker.client.ConsumerGroupInfo;\\nimport org.apache.rocketmq.broker.client.ConsumerManager;\\nimport org.apache.rocketmq.broker.filter.ConsumerFilterData;\\nimport org.apache.rocketmq.broker.filter.ConsumerFilterManager;\\nimport org.apache.rocketmq.broker.filter.ExpressionMessageFilter;\\nimport org.apache.rocketmq.broker.offset.ConsumerOffsetManager;\\nimport org.apache.rocketmq.broker.processor.PopBufferMergeService;\\nimport org.apache.rocketmq.broker.processor.PopInflightMessageCounter;\\nimport org.apache.rocketmq.broker.subscription.SubscriptionGroupManager;\\nimport org.apache.rocketmq.broker.topic.TopicConfigManager;\\nimport org.apache.rocketmq.common.BrokerConfig;\\nimport org.apache.rocketmq.common.KeyBuilder;\\nimport org.apache.rocketmq.common.MixAll;\\nimport org.apache.rocketmq.common.Pair;\\nimport org.apache.rocketmq.common.TopicConfig;\\nimport org.apache.rocketmq.common.constant.LoggerName;\\nimport org.apache.rocketmq.common.constant.PermName;\\nimport org.apache.rocketmq.common.filter.ExpressionType;\\nimport org.apache.rocketmq.logging.org.slf4j.Logger;\\nimport org.apache.rocketmq.logging.org.slf4j.LoggerFactory;\\nimport org.apache.rocketmq.remoting.protocol.filter.FilterAPI;\\nimport org.apache.rocketmq.remoting.protocol.heartbeat.ConsumeType;\\nimport org.apache.rocketmq.remoting.protocol.heartbeat.SubscriptionData;\\nimport org.apache.rocketmq.remoting.protocol.subscription.SimpleSubscriptionData;\\nimport org.apache.rocketmq.remoting.protocol.subscription.SubscriptionGroupConfig;\\nimport org.apache.rocketmq.store.DefaultMessageFilter;\\nimport org.apache.rocketmq.store.MessageStore;\\n\"},{\"fromLine\":53,\"toLine\":61,\"content\":\"    private final BrokerConfig brokerConfig;\\n    private final TopicConfigManager topicConfigManager;\\n    private final ConsumerManager consumerManager;\\n    private final ConsumerOffsetManager offsetManager;\\n    private final ConsumerFilterManager consumerFilterManager;\\n    private final SubscriptionGroupManager subscriptionGroupManager;\\n    private final MessageStore messageStore;\\n    private final PopBufferMergeService popBufferMergeService;\\n    private final PopInflightMessageCounter popInflightMessageCounter;\"},{\"fromLine\":63,\"toLine\":63,\"content\":\"    private static final Logger LOGGER = LoggerFactory.getLogger(LoggerName.BROKER_LOGGER_NAME);\"},{\"fromLine\":275,\"toLine\":275,\"content\":\"    public Pair<Long, Long> getConsumerLagStats(String group, String topic, boolean isPop) {\"},{\"fromLine\":301,\"toLine\":301,\"content\":\"    public Pair<Long, Long> getConsumerLagStats(String group, String topic, int queueId, boolean isPop) {\"},{\"fromLine\":332,\"toLine\":332,\"content\":\"    public Pair<Long, Long> getInFlightMsgStats(String group, String topic, boolean isPop) {\"},{\"fromLine\":358,\"toLine\":358,\"content\":\"    public Pair<Long, Long> getInFlightMsgStats(String group, String topic, int queueId, boolean isPop) {\"},{\"fromLine\":387,\"toLine\":387,\"content\":\"    public long getAvailableMsgCount(String group, String topic, boolean isPop) {\"},{\"fromLine\":406,\"toLine\":406,\"content\":\"    public long getAvailableMsgCount(String group, String topic, int queueId, boolean isPop) {\"},{\"fromLine\":431,\"toLine\":431,\"content\":\"    public long getStoreTimeStamp(String topic, int queueId, long offset) {\"},{\"fromLine\":440,\"toLine\":440,\"content\":\"    public long calculateMessageCount(String group, String topic, int queueId, long from, long to) {\"}],\"broker/src/main/java/org/apache/rocketmq/broker/out/BrokerOuterAPI.java\":[{\"fromLine\":16,\"toLine\":150,\"content\":\" */\\npackage org.apache.rocketmq.broker.out;\\n\\nimport com.alibaba.fastjson2.JSON;\\nimport java.io.UnsupportedEncodingException;\\nimport java.net.InetAddress;\\nimport java.nio.ByteBuffer;\\nimport java.util.ArrayList;\\nimport java.util.Arrays;\\nimport java.util.List;\\nimport java.util.Set;\\nimport java.util.concurrent.ArrayBlockingQueue;\\nimport java.util.concurrent.CompletableFuture;\\nimport java.util.concurrent.CopyOnWriteArrayList;\\nimport java.util.concurrent.CountDownLatch;\\nimport java.util.concurrent.ExecutorService;\\nimport java.util.concurrent.TimeUnit;\\nimport org.apache.commons.lang3.StringUtils;\\nimport org.apache.rocketmq.acl.common.AclClientRPCHook;\\nimport org.apache.rocketmq.acl.common.SessionCredentials;\\nimport org.apache.rocketmq.auth.config.AuthConfig;\\nimport org.apache.rocketmq.client.consumer.PullResult;\\nimport org.apache.rocketmq.client.consumer.PullStatus;\\nimport org.apache.rocketmq.client.exception.MQBrokerException;\\nimport org.apache.rocketmq.client.impl.consumer.PullResultExt;\\nimport org.apache.rocketmq.client.producer.SendResult;\\nimport org.apache.rocketmq.client.producer.SendStatus;\\nimport org.apache.rocketmq.common.AbstractBrokerRunnable;\\nimport org.apache.rocketmq.common.BrokerIdentity;\\nimport org.apache.rocketmq.common.LockCallback;\\nimport org.apache.rocketmq.common.MixAll;\\nimport org.apache.rocketmq.common.Pair;\\nimport org.apache.rocketmq.common.ThreadFactoryImpl;\\nimport org.apache.rocketmq.common.TopicConfig;\\nimport org.apache.rocketmq.common.UnlockCallback;\\nimport org.apache.rocketmq.common.UtilAll;\\nimport org.apache.rocketmq.common.constant.LoggerName;\\nimport org.apache.rocketmq.common.filter.ExpressionType;\\nimport org.apache.rocketmq.common.message.Message;\\nimport org.apache.rocketmq.common.message.MessageAccessor;\\nimport org.apache.rocketmq.common.message.MessageBatch;\\nimport org.apache.rocketmq.common.message.MessageClientIDSetter;\\nimport org.apache.rocketmq.common.message.MessageConst;\\nimport org.apache.rocketmq.common.message.MessageDecoder;\\nimport org.apache.rocketmq.common.message.MessageExt;\\nimport org.apache.rocketmq.common.message.MessageQueue;\\nimport org.apache.rocketmq.common.namesrv.DefaultTopAddressing;\\nimport org.apache.rocketmq.common.namesrv.TopAddressing;\\nimport org.apache.rocketmq.common.sysflag.PullSysFlag;\\nimport org.apache.rocketmq.common.topic.TopicValidator;\\nimport org.apache.rocketmq.common.utils.ThreadUtils;\\nimport org.apache.rocketmq.logging.org.slf4j.Logger;\\nimport org.apache.rocketmq.logging.org.slf4j.LoggerFactory;\\nimport org.apache.rocketmq.remoting.InvokeCallback;\\nimport org.apache.rocketmq.remoting.RPCHook;\\nimport org.apache.rocketmq.remoting.RemotingClient;\\nimport org.apache.rocketmq.remoting.exception.RemotingCommandException;\\nimport org.apache.rocketmq.remoting.exception.RemotingConnectException;\\nimport org.apache.rocketmq.remoting.exception.RemotingException;\\nimport org.apache.rocketmq.remoting.exception.RemotingSendRequestException;\\nimport org.apache.rocketmq.remoting.exception.RemotingTimeoutException;\\nimport org.apache.rocketmq.remoting.exception.RemotingTooMuchRequestException;\\nimport org.apache.rocketmq.remoting.netty.NettyClientConfig;\\nimport org.apache.rocketmq.remoting.netty.NettyRemotingClient;\\nimport org.apache.rocketmq.remoting.netty.ResponseFuture;\\nimport org.apache.rocketmq.remoting.protocol.BrokerSyncInfo;\\nimport org.apache.rocketmq.remoting.protocol.DataVersion;\\nimport org.apache.rocketmq.remoting.protocol.RemotingCommand;\\nimport org.apache.rocketmq.remoting.protocol.RemotingSerializable;\\nimport org.apache.rocketmq.remoting.protocol.RequestCode;\\nimport org.apache.rocketmq.remoting.protocol.ResponseCode;\\nimport org.apache.rocketmq.remoting.protocol.body.BrokerMemberGroup;\\nimport org.apache.rocketmq.remoting.protocol.body.ClusterInfo;\\nimport org.apache.rocketmq.remoting.protocol.body.ConsumerOffsetSerializeWrapper;\\nimport org.apache.rocketmq.remoting.protocol.body.ElectMasterResponseBody;\\nimport org.apache.rocketmq.remoting.protocol.body.GetBrokerMemberGroupResponseBody;\\nimport org.apache.rocketmq.remoting.protocol.body.KVTable;\\nimport org.apache.rocketmq.remoting.protocol.body.LockBatchRequestBody;\\nimport org.apache.rocketmq.remoting.protocol.body.LockBatchResponseBody;\\nimport org.apache.rocketmq.remoting.protocol.body.MessageRequestModeSerializeWrapper;\\nimport org.apache.rocketmq.remoting.protocol.body.RegisterBrokerBody;\\nimport org.apache.rocketmq.remoting.protocol.body.SubscriptionGroupWrapper;\\nimport org.apache.rocketmq.remoting.protocol.body.SyncStateSet;\\nimport org.apache.rocketmq.remoting.protocol.body.TopicConfigAndMappingSerializeWrapper;\\nimport org.apache.rocketmq.remoting.protocol.body.TopicConfigSerializeWrapper;\\nimport org.apache.rocketmq.remoting.protocol.body.UnlockBatchRequestBody;\\nimport org.apache.rocketmq.remoting.protocol.header.ExchangeHAInfoRequestHeader;\\nimport org.apache.rocketmq.remoting.protocol.header.ExchangeHAInfoResponseHeader;\\nimport org.apache.rocketmq.remoting.protocol.header.GetBrokerMemberGroupRequestHeader;\\nimport org.apache.rocketmq.remoting.protocol.header.GetMaxOffsetRequestHeader;\\nimport org.apache.rocketmq.remoting.protocol.header.GetMaxOffsetResponseHeader;\\nimport org.apache.rocketmq.remoting.protocol.header.GetMinOffsetRequestHeader;\\nimport org.apache.rocketmq.remoting.protocol.header.GetMinOffsetResponseHeader;\\nimport org.apache.rocketmq.remoting.protocol.header.LockBatchMqRequestHeader;\\nimport org.apache.rocketmq.remoting.protocol.header.PullMessageRequestHeader;\\nimport org.apache.rocketmq.remoting.protocol.header.PullMessageResponseHeader;\\nimport org.apache.rocketmq.remoting.protocol.header.SendMessageRequestHeader;\\nimport org.apache.rocketmq.remoting.protocol.header.SendMessageRequestHeaderV2;\\nimport org.apache.rocketmq.remoting.protocol.header.SendMessageResponseHeader;\\nimport org.apache.rocketmq.remoting.protocol.header.UnlockBatchMqRequestHeader;\\nimport org.apache.rocketmq.remoting.protocol.header.controller.AlterSyncStateSetRequestHeader;\\nimport org.apache.rocketmq.remoting.protocol.header.controller.ElectMasterRequestHeader;\\nimport org.apache.rocketmq.remoting.protocol.header.controller.ElectMasterResponseHeader;\\nimport org.apache.rocketmq.remoting.protocol.header.controller.GetMetaDataResponseHeader;\\nimport org.apache.rocketmq.remoting.protocol.header.controller.GetReplicaInfoRequestHeader;\\nimport org.apache.rocketmq.remoting.protocol.header.controller.GetReplicaInfoResponseHeader;\\nimport org.apache.rocketmq.remoting.protocol.header.controller.register.ApplyBrokerIdRequestHeader;\\nimport org.apache.rocketmq.remoting.protocol.header.controller.register.ApplyBrokerIdResponseHeader;\\nimport org.apache.rocketmq.remoting.protocol.header.controller.register.GetNextBrokerIdRequestHeader;\\nimport org.apache.rocketmq.remoting.protocol.header.controller.register.GetNextBrokerIdResponseHeader;\\nimport org.apache.rocketmq.remoting.protocol.header.controller.register.RegisterBrokerToControllerRequestHeader;\\nimport org.apache.rocketmq.remoting.protocol.header.controller.register.RegisterBrokerToControllerResponseHeader;\\nimport org.apache.rocketmq.remoting.protocol.header.namesrv.BrokerHeartbeatRequestHeader;\\nimport org.apache.rocketmq.remoting.protocol.header.namesrv.GetRouteInfoRequestHeader;\\nimport org.apache.rocketmq.remoting.protocol.header.namesrv.QueryDataVersionRequestHeader;\\nimport org.apache.rocketmq.remoting.protocol.header.namesrv.QueryDataVersionResponseHeader;\\nimport org.apache.rocketmq.remoting.protocol.header.namesrv.RegisterBrokerRequestHeader;\\nimport org.apache.rocketmq.remoting.protocol.header.namesrv.RegisterBrokerResponseHeader;\\nimport org.apache.rocketmq.remoting.protocol.header.namesrv.RegisterTopicRequestHeader;\\nimport org.apache.rocketmq.remoting.protocol.header.namesrv.UnRegisterBrokerRequestHeader;\\nimport org.apache.rocketmq.remoting.protocol.heartbeat.SubscriptionData;\\nimport org.apache.rocketmq.remoting.protocol.namesrv.RegisterBrokerResult;\\nimport org.apache.rocketmq.remoting.protocol.route.BrokerData;\\nimport org.apache.rocketmq.remoting.protocol.route.QueueData;\\nimport org.apache.rocketmq.remoting.protocol.route.TopicRouteData;\\nimport org.apache.rocketmq.remoting.rpc.ClientMetadata;\\nimport org.apache.rocketmq.remoting.rpc.RpcClient;\\nimport org.apache.rocketmq.remoting.rpc.RpcClientImpl;\\nimport org.apache.rocketmq.remoting.rpchook.DynamicalExtFieldRPCHook;\\nimport org.apache.rocketmq.store.timer.TimerCheckpoint;\\nimport org.apache.rocketmq.store.timer.TimerMetrics;\\n\\nimport static org.apache.rocketmq.remoting.protocol.RemotingSysResponseCode.SUCCESS;\\nimport static org.apache.rocketmq.remoting.protocol.ResponseCode.CONTROLLER_MASTER_STILL_EXIST;\\n\"},{\"fromLine\":152,\"toLine\":155,\"content\":\"    private static final Logger LOGGER = LoggerFactory.getLogger(LoggerName.BROKER_LOGGER_NAME);\\n    private final RemotingClient remotingClient;\\n    private final TopAddressing topAddressing = new DefaultTopAddressing(MixAll.getWSAddr());\\n    private final ExecutorService brokerOuterExecutor = ThreadUtils.newThreadPoolExecutor(4, 10, 1, TimeUnit.MINUTES,\"},{\"fromLine\":157,\"toLine\":159,\"content\":\"    private final ClientMetadata clientMetadata;\\n    private final RpcClient rpcClient;\\n    private String nameSrvAddr = null;\"},{\"fromLine\":253,\"toLine\":254,\"content\":\"    public BrokerMemberGroup syncBrokerMemberGroup(String clusterName, String brokerName,\\n        boolean isCompatibleWithOldNameSrv)\"},{\"fromLine\":331,\"toLine\":337,\"content\":\"        final String clusterName,\\n        final String brokerAddr,\\n        final String brokerName,\\n        final Long brokerId,\\n        final int timeoutMillis,\\n        final DataVersion dataVersion,\\n        final boolean isInBrokerContainer) {\"},{\"fromLine\":365,\"toLine\":370,\"content\":\"    public void sendHeartbeat(final String clusterName,\\n        final String brokerAddr,\\n        final String brokerName,\\n        final Long brokerId,\\n        final int timeoutMills,\\n        final boolean isInBrokerContainer) {\"},{\"fromLine\":418,\"toLine\":418,\"content\":\"    public void sendBrokerHaInfo(String brokerAddr, String masterHaAddr, long brokerInitMaxOffset, String masterAddr)\"},{\"fromLine\":442,\"toLine\":453,\"content\":\"        final String clusterName,\\n        final String brokerAddr,\\n        final String brokerName,\\n        final long brokerId,\\n        final String haServerAddr,\\n        final TopicConfigSerializeWrapper topicConfigWrapper,\\n        final List<String> filterServerList,\\n        final boolean oneway,\\n        final int timeoutMills,\\n        final boolean enableActingMaster,\\n        final boolean compressed,\\n        final BrokerIdentity brokerIdentity) {\"},{\"fromLine\":485,\"toLine\":497,\"content\":\"        final String clusterName,\\n        final String brokerAddr,\\n        final String brokerName,\\n        final long brokerId,\\n        final String haServerAddr,\\n        final TopicConfigSerializeWrapper topicConfigWrapper,\\n        final List<String> filterServerList,\\n        final boolean oneway,\\n        final int timeoutMills,\\n        final boolean enableActingMaster,\\n        final boolean compressed,\\n        final Long heartbeatTimeoutMillis,\\n        final BrokerIdentity brokerIdentity) {\"},{\"fromLine\":554,\"toLine\":558,\"content\":\"        final String namesrvAddr,\\n        final boolean oneway,\\n        final int timeoutMills,\\n        final RegisterBrokerRequestHeader requestHeader,\\n        final byte[] body\"},{\"fromLine\":595,\"toLine\":598,\"content\":\"        final String clusterName,\\n        final String brokerAddr,\\n        final String brokerName,\\n        final long brokerId\"},{\"fromLine\":614,\"toLine\":618,\"content\":\"        final String namesrvAddr,\\n        final String clusterName,\\n        final String brokerAddr,\\n        final String brokerName,\\n        final long brokerId\"},{\"fromLine\":645,\"toLine\":647,\"content\":\"        final String brokerName,\\n        final TopicConfig topicConfig,\\n        final int timeoutMills) {\"},{\"fromLine\":699,\"toLine\":705,\"content\":\"        final String clusterName,\\n        final String brokerAddr,\\n        final String brokerName,\\n        final long brokerId,\\n        final TopicConfigSerializeWrapper topicConfigWrapper,\\n        final int timeoutMills,\\n        final boolean isInBrokerContainer) {\"},{\"fromLine\":877,\"toLine\":878,\"content\":\"    public long getMaxOffset(final String addr, final String topic, final int queueId, final boolean committed,\\n        final boolean isOnlyThisBroker)\"},{\"fromLine\":901,\"toLine\":901,\"content\":\"    public long getMinOffset(final String addr, final String topic, final int queueId, final boolean isOnlyThisBroker)\"},{\"fromLine\":924,\"toLine\":927,\"content\":\"        final String addr,\\n        final LockBatchRequestBody requestBody,\\n        final long timeoutMillis,\\n        final LockCallback callback) throws RemotingException, InterruptedException {\"},{\"fromLine\":963,\"toLine\":966,\"content\":\"        final String addr,\\n        final UnlockBatchRequestBody requestBody,\\n        final long timeoutMillis,\\n        final UnlockCallback callback) throws RemotingException, InterruptedException {\"},{\"fromLine\":1003,\"toLine\":1005,\"content\":\"    public SendResult sendMessageToSpecificBroker(String brokerAddr, final String brokerName,\\n        final MessageExt msg, String group,\\n        long timeoutMillis) throws RemotingException, MQBrokerException, InterruptedException {\"},{\"fromLine\":1012,\"toLine\":1014,\"content\":\"    public CompletableFuture<SendResult> sendMessageToSpecificBrokerAsync(String brokerAddr, final String brokerName,\\n        final MessageExt msg, String group,\\n        long timeoutMillis) {\"},{\"fromLine\":1076,\"toLine\":1078,\"content\":\"        final String brokerName,\\n        final Message msg,\\n        final RemotingCommand response\"},{\"fromLine\":1145,\"toLine\":1146,\"content\":\"    public TopicRouteData getTopicRouteInfoFromNameServer(final String topic, final long timeoutMillis,\\n        boolean allowTopicNotExist) throws MQBrokerException, InterruptedException, RemotingTimeoutException, RemotingSendRequestException, RemotingConnectException {\"},{\"fromLine\":1190,\"toLine\":1191,\"content\":\"    public void forwardRequest(String brokerAddr, RemotingCommand request, long timeoutMillis,\\n        InvokeCallback invokeCallback) throws InterruptedException, RemotingSendRequestException, RemotingTimeoutException, RemotingTooMuchRequestException, RemotingConnectException {\"},{\"fromLine\":1239,\"toLine\":1242,\"content\":\"        final String controllerAddress,\\n        final String brokerName,\\n        final Long masterBrokerId, final int masterEpoch,\\n        final Set<Long> newSyncStateSet, final int syncStateSetEpoch) throws Exception {\"},{\"fromLine\":1261,\"toLine\":1263,\"content\":\"    public Pair<ElectMasterResponseHeader, Set<Long>> brokerElect(String controllerAddress, String clusterName,\\n        String brokerName,\\n        Long brokerId) throws Exception {\"},{\"fromLine\":1281,\"toLine\":1282,\"content\":\"    public GetNextBrokerIdResponseHeader getNextBrokerId(final String clusterName, final String brokerName,\\n        final String controllerAddress) throws Exception {\"},{\"fromLine\":1293,\"toLine\":1294,\"content\":\"    public ApplyBrokerIdResponseHeader applyBrokerId(final String clusterName, final String brokerName,\\n        final Long brokerId, final String registerCheckCode, final String controllerAddress) throws Exception {\"},{\"fromLine\":1306,\"toLine\":1307,\"content\":\"        final String clusterName, final String brokerName, final Long brokerId, final String brokerAddress,\\n        final String controllerAddress) throws Exception {\"},{\"fromLine\":1343,\"toLine\":1354,\"content\":\"    public void sendHeartbeatToController(final String controllerAddress,\\n        final String clusterName,\\n        final String brokerAddr,\\n        final String brokerName,\\n        final Long brokerId,\\n        final int sendHeartBeatTimeoutMills,\\n        final boolean isInBrokerContainer,\\n        final int epoch,\\n        final long maxOffset,\\n        final long confirmOffset,\\n        final long controllerHeartBeatTimeoutMills,\\n        final int electionPriority) {\"},{\"fromLine\":1383,\"toLine\":1385,\"content\":\"    public CompletableFuture<PullResult> pullMessageFromSpecificBrokerAsync(String brokerName, String brokerAddr,\\n        String consumerGroup, String topic, int queueId, long offset,\\n        int maxNums, long timeoutMillis) throws RemotingException, InterruptedException {\"},{\"fromLine\":1458,\"toLine\":1458,\"content\":\"    private PullResult processPullResult(final PullResultExt pullResult, String brokerName, int queueId) {\"}],\"broker/src/main/java/org/apache/rocketmq/broker/failover/EscapeBridge.java\":[{\"fromLine\":17,\"toLine\":54,\"content\":\"\\npackage org.apache.rocketmq.broker.failover;\\n\\nimport java.nio.ByteBuffer;\\nimport java.util.ArrayList;\\nimport java.util.List;\\nimport java.util.concurrent.BlockingQueue;\\nimport java.util.concurrent.CompletableFuture;\\nimport java.util.concurrent.ExecutorService;\\nimport java.util.concurrent.LinkedBlockingQueue;\\nimport java.util.concurrent.TimeUnit;\\nimport org.apache.commons.lang3.StringUtils;\\nimport org.apache.rocketmq.broker.BrokerController;\\nimport org.apache.rocketmq.broker.transaction.queue.TransactionalMessageUtil;\\nimport org.apache.rocketmq.client.consumer.PullStatus;\\nimport org.apache.rocketmq.client.exception.MQBrokerException;\\nimport org.apache.rocketmq.client.impl.producer.TopicPublishInfo;\\nimport org.apache.rocketmq.client.producer.SendResult;\\nimport org.apache.rocketmq.client.producer.SendStatus;\\nimport org.apache.rocketmq.common.MixAll;\\nimport org.apache.rocketmq.common.Pair;\\nimport org.apache.rocketmq.common.ThreadFactoryImpl;\\nimport org.apache.rocketmq.common.constant.LoggerName;\\nimport org.apache.rocketmq.common.message.MessageConst;\\nimport org.apache.rocketmq.common.message.MessageDecoder;\\nimport org.apache.rocketmq.common.message.MessageExt;\\nimport org.apache.rocketmq.common.message.MessageExtBrokerInner;\\nimport org.apache.rocketmq.common.message.MessageQueue;\\nimport org.apache.rocketmq.common.utils.ThreadUtils;\\nimport org.apache.rocketmq.logging.org.slf4j.Logger;\\nimport org.apache.rocketmq.logging.org.slf4j.LoggerFactory;\\nimport org.apache.rocketmq.remoting.exception.RemotingException;\\nimport org.apache.rocketmq.store.GetMessageResult;\\nimport org.apache.rocketmq.store.GetMessageStatus;\\nimport org.apache.rocketmq.store.MessageStore;\\nimport org.apache.rocketmq.store.PutMessageResult;\\nimport org.apache.rocketmq.store.PutMessageStatus;\\n\"},{\"fromLine\":56,\"toLine\":60,\"content\":\"    protected static final Logger LOG = LoggerFactory.getLogger(LoggerName.BROKER_LOGGER_NAME);\\n    private static final long SEND_TIMEOUT = 3000L;\\n    private static final long DEFAULT_PULL_TIMEOUT_MILLIS = 1000 * 10L;\\n    private final String innerProducerGroupName;\\n    private final String innerConsumerGroupName;\"},{\"fromLine\":62,\"toLine\":62,\"content\":\"    private final BrokerController brokerController;\"},{\"fromLine\":64,\"toLine\":64,\"content\":\"    private ExecutorService defaultAsyncSenderExecutor;\"},{\"fromLine\":266,\"toLine\":266,\"content\":\"    public Pair<GetMessageStatus, MessageExt> getMessage(String topic, long offset, int queueId, String brokerName, boolean deCompressBody) {\"},{\"fromLine\":270,\"toLine\":270,\"content\":\"    public CompletableFuture<Pair<GetMessageStatus, MessageExt>> getMessageAsync(String topic, long offset, int queueId, String brokerName, boolean deCompressBody) {\"},{\"fromLine\":325,\"toLine\":325,\"content\":\"    protected MessageExt getMessageFromRemote(String topic, long offset, int queueId, String brokerName) {\"},{\"fromLine\":329,\"toLine\":329,\"content\":\"    protected CompletableFuture<MessageExt> getMessageFromRemoteAsync(String topic, long offset, int queueId, String brokerName) {\"}],\"remoting/src/main/java/org/apache/rocketmq/remoting/protocol/filter/FilterAPI.java\":[{\"fromLine\":16,\"toLine\":24,\"content\":\" */\\npackage org.apache.rocketmq.remoting.protocol.filter;\\n\\nimport org.apache.commons.lang3.StringUtils;\\nimport org.apache.rocketmq.common.filter.ExpressionType;\\nimport org.apache.rocketmq.remoting.protocol.heartbeat.SubscriptionData;\\n\\nimport java.util.Arrays;\\n\"},{\"fromLine\":49,\"toLine\":49,\"content\":\"    public static SubscriptionData buildSubscriptionData(String topic, String subString, String expressionType) throws Exception {\"},{\"fromLine\":57,\"toLine\":58,\"content\":\"    public static SubscriptionData build(final String topic, final String subString,\\n        final String type) throws Exception {\"}],\"remoting/src/main/java/org/apache/rocketmq/remoting/protocol/heartbeat/SubscriptionData.java\":[{\"fromLine\":20,\"toLine\":27,\"content\":\" */\\npackage org.apache.rocketmq.remoting.protocol.heartbeat;\\n\\nimport com.alibaba.fastjson.annotation.JSONField;\\nimport java.util.HashSet;\\nimport java.util.Set;\\nimport org.apache.rocketmq.common.filter.ExpressionType;\\n\"},{\"fromLine\":29,\"toLine\":36,\"content\":\"    public final static String SUB_ALL = \\\"*\\\";\\n    private boolean classFilterMode = false;\\n    private String topic;\\n    private String subString;\\n    private Set<String> tagsSet = new HashSet<>();\\n    private Set<Integer> codeSet = new HashSet<>();\\n    private long subVersion = System.currentTimeMillis();\\n    private String expressionType = ExpressionType.TAG;\"},{\"fromLine\":39,\"toLine\":39,\"content\":\"    private String filterClassSource;\"}]}",
            "role": "user"
        }
    ],
    "model": "gpt-4-1106-preview",
    "response_format": {
        "type": "json_object"
    },
    "temperature": 0.5
}